{
  "hash": "bd2aae6d55d0d4127510100696211912",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 1\"\nauthor: \"Cathy C.\"\ndate: \"February 1, 2025\"\ndate-modified: \"last-modified\"\nexecute:\n  echo: true \n  eval: true #no more rendering if no further changes\n  warning: false \n  freeze: true \n---\n\n\n\n\n## 1 Overview\n\n### 1.1 Abstract\n\n\\[placeholder\\]\n\n### 1.2 Task\n\nAn international media company that publishes weekly content on digital platforms is planning to release articles on \"Ship Performance in the Gulf of Guinea\". As a graphical editor of the media company, I am going to prepare data visualisation for the article focusing on ship performance assessment.\n\nThis report will use Exploratory Data Analysis (EDA) methods and ggplot2 functions to visualise insights on 1) Ships' profitability and 2)Operational factors affecting voyage performance.\n\n## 2 Install and Load Packages\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, ggplot2, haven, knitr, patchwork, ggthemes, \n               ggridges, gganimate,ggdist, ggtext, colorspace, magrittr, \n               patchwork, RColorBrewer, ggstatsplot, egg, geomtextpath, \n               readxl, performance, parameters, see)\n```\n:::\n\n\n\n\n| Packages     | Description |\n|--------------|-------------|\n| tidyverse    | 2.05        |\n| ggplot2      | 1.37        |\n| haven        | 3.09        |\n| colorspace   | 3.09        |\n| egg          | 3.09        |\n| geomtextpath | 3.09        |\n| gganimate    | 3.09        |\n| ggdist       | 3.09        |\n| ggplot2      | 3.09        |\n| ggstatsplot  | 3.09        |\n| ggtext       | 3.09        |\n| ggthemes     | 3.09        |\n| ggridges     | 3.09        |\n| haven        | 3.09        |\n| knitr        | 3.09        |\n| magrittr     | 3.09        |\n| patchwork    | 3.09        |\n| performance  | 3.09        |\n| parameters   | 3.09        |\n| readxl       | 3.09        |\n| RColorBrewer | 3.09        |\n| see          | 3.09        |\n| tidyverse    | 3.09        |\n\n: {tbl-colwidths=\"\\[20,80\\]\"}\n\n## 3 Data Preparation\n\nThe dataset [Ship Performance Clustering Dataset](https://www.kaggle.com/datasets/jeleeladekunlefijabi/ship-performance-clustering-dataset) is downloaded from Kagglel.com. This file contains a detailed dataset focusing on the operational performance of various ship types across different routes. Each row represents the performance metrics and attributes for a specific voyage or ship over a given timeframe.\n\n### 3.1 Import file and check\n\nImport the csv file using `read_csv()`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_ship <- read_csv(\"data/Ship_Pfm_Dataset.csv\")\n```\n:::\n\n\n\n\nNext I would like to observe the variables and their data type and understand the dataset.\n\nThe dataset consists of 18 columns and 2,736 rows (observations). Each observation contains an entry recording a voyage for which the ship's profile and operational information. As the result of code shows, there are 5 categorical variables, 1 date variable and 12 numerical variables.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(data_ship)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 2,736\nColumns: 18\n$ Date                    <date> 2023-06-04, 2023-06-11, 2023-06-18, 2023-06-2…\n$ Ship_Type               <chr> \"Container Ship\", \"Fish Carrier\", \"Container S…\n$ Route_Type              <chr> \"None\", \"Short-haul\", \"Long-haul\", \"Transocean…\n$ Engine_Type             <chr> \"Heavy Fuel Oil (HFO)\", \"Steam Turbine\", \"Dies…\n$ Maintenance_Status      <chr> \"Critical\", \"Good\", \"Fair\", \"Fair\", \"Fair\", \"F…\n$ Speed_Over_Ground_knots <dbl> 12.59756, 10.38758, 20.74975, 21.05510, 13.742…\n$ Engine_Power_kW         <dbl> 2062.9840, 1796.0574, 1648.5567, 915.2618, 108…\n$ Distance_Traveled_nm    <dbl> 1030.9436, 1060.4864, 658.8741, 1126.8225, 144…\n$ Draft_meters            <dbl> 14.132284, 14.653083, 7.199261, 11.789063, 9.7…\n$ Weather_Condition       <chr> \"Moderate\", \"Rough\", \"Moderate\", \"Moderate\", \"…\n$ Cargo_Weight_tons       <dbl> 1959.0179, 162.3947, 178.0409, 1737.3853, 260.…\n$ Operational_Cost_USD    <dbl> 483832.35, 483388.00, 448543.40, 261349.61, 28…\n$ Revenue_per_Voyage_USD  <dbl> 292183.27, 883765.79, 394018.75, 87551.38, 676…\n$ Turnaround_Time_hours   <dbl> 25.86708, 63.24820, 49.41815, 22.40911, 64.158…\n$ Efficiency_nm_per_kWh   <dbl> 1.4551789, 0.2903614, 0.4995945, 0.7029057, 1.…\n$ Seasonal_Impact_Score   <dbl> 1.4156533, 0.8856478, 1.4058132, 1.3707043, 0.…\n$ Weekly_Voyage_Count     <dbl> 1, 6, 9, 1, 8, 7, 3, 6, 8, 2, 9, 4, 3, 7, 7, 3…\n$ Average_Load_Percentage <dbl> 93.76925, 93.89537, 96.21824, 66.19370, 80.008…\n```\n\n\n:::\n:::\n\n\n\n\n### 3.2 Data Wrangling\n\nThe diagram below shows the variables selected for this study:\n\n\\[placeholder\\]\n\n#### **3.2.1 Add a variable**\n\nTo assess the ships' finance performance, I will add a variable **Profit**, deriving from Revenue_per_Voyage_USD subtracting Operational_Cost_USD.\n\n***Profit = (Revenue_per_Voyage_USD - Operational_Cost_USD)***\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\ndata_ship <- data_ship %>%\n  mutate(Profit = Revenue_per_Voyage_USD - Operational_Cost_USD)\n```\n:::\n\n\n\n\nNow, I will use `str()` to have a look and confirm **Profit** is added to the data frame and the data type is numeric.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(data_ship)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [2,736 × 19] (S3: tbl_df/tbl/data.frame)\n $ Date                   : Date[1:2736], format: \"2023-06-04\" \"2023-06-11\" ...\n $ Ship_Type              : chr [1:2736] \"Container Ship\" \"Fish Carrier\" \"Container Ship\" \"Bulk Carrier\" ...\n $ Route_Type             : chr [1:2736] \"None\" \"Short-haul\" \"Long-haul\" \"Transoceanic\" ...\n $ Engine_Type            : chr [1:2736] \"Heavy Fuel Oil (HFO)\" \"Steam Turbine\" \"Diesel\" \"Steam Turbine\" ...\n $ Maintenance_Status     : chr [1:2736] \"Critical\" \"Good\" \"Fair\" \"Fair\" ...\n $ Speed_Over_Ground_knots: num [1:2736] 12.6 10.4 20.7 21.1 13.7 ...\n $ Engine_Power_kW        : num [1:2736] 2063 1796 1649 915 1090 ...\n $ Distance_Traveled_nm   : num [1:2736] 1031 1060 659 1127 1445 ...\n $ Draft_meters           : num [1:2736] 14.13 14.65 7.2 11.79 9.73 ...\n $ Weather_Condition      : chr [1:2736] \"Moderate\" \"Rough\" \"Moderate\" \"Moderate\" ...\n $ Cargo_Weight_tons      : num [1:2736] 1959 162 178 1737 261 ...\n $ Operational_Cost_USD   : num [1:2736] 483832 483388 448543 261350 287718 ...\n $ Revenue_per_Voyage_USD : num [1:2736] 292183 883766 394019 87551 676121 ...\n $ Turnaround_Time_hours  : num [1:2736] 25.9 63.2 49.4 22.4 64.2 ...\n $ Efficiency_nm_per_kWh  : num [1:2736] 1.455 0.29 0.5 0.703 1.331 ...\n $ Seasonal_Impact_Score  : num [1:2736] 1.416 0.886 1.406 1.371 0.583 ...\n $ Weekly_Voyage_Count    : num [1:2736] 1 6 9 1 8 7 3 6 8 2 ...\n $ Average_Load_Percentage: num [1:2736] 93.8 93.9 96.2 66.2 80 ...\n $ Profit                 : num [1:2736] -191649 400378 -54525 -173798 388403 ...\n```\n\n\n:::\n:::\n\n\n\n\nNext, let's use `summary()` to run a summary of the dataset to understand the overall statistics of the data.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(data_ship)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Date             Ship_Type          Route_Type        Engine_Type       \n Min.   :2023-06-04   Length:2736        Length:2736        Length:2736       \n 1st Qu.:2023-09-10   Class :character   Class :character   Class :character  \n Median :2023-12-17   Mode  :character   Mode  :character   Mode  :character  \n Mean   :2023-12-17                                                           \n 3rd Qu.:2024-03-24                                                           \n Max.   :2024-06-30                                                           \n Maintenance_Status Speed_Over_Ground_knots Engine_Power_kW\n Length:2736        Min.   :10.01           Min.   : 501   \n Class :character   1st Qu.:13.93           1st Qu.:1148   \n Mode  :character   Median :17.71           Median :1757   \n                    Mean   :17.60           Mean   :1758   \n                    3rd Qu.:21.28           3rd Qu.:2383   \n                    Max.   :25.00           Max.   :2999   \n Distance_Traveled_nm  Draft_meters    Weather_Condition  Cargo_Weight_tons\n Min.   :  50.43      Min.   : 5.002   Length:2736        Min.   :  50.23  \n 1st Qu.: 548.51      1st Qu.: 7.437   Class :character   1st Qu.: 553.98  \n Median :1037.82      Median : 9.919   Mode  :character   Median :1043.21  \n Mean   :1036.41      Mean   : 9.929                      Mean   :1032.57  \n 3rd Qu.:1540.93      3rd Qu.:12.413                      3rd Qu.:1527.72  \n Max.   :1998.34      Max.   :14.993                      Max.   :1999.13  \n Operational_Cost_USD Revenue_per_Voyage_USD Turnaround_Time_hours\n Min.   : 10092       Min.   : 50352         Min.   :12.02        \n 1st Qu.:131293       1st Qu.:290346         1st Qu.:26.17        \n Median :257158       Median :520177         Median :41.59        \n Mean   :255143       Mean   :521362         Mean   :41.75        \n 3rd Qu.:381797       3rd Qu.:750073         3rd Qu.:57.36        \n Max.   :499735       Max.   :999917         Max.   :71.97        \n Efficiency_nm_per_kWh Seasonal_Impact_Score Weekly_Voyage_Count\n Min.   :0.1002        Min.   :0.500         Min.   :1.000      \n 1st Qu.:0.4636        1st Qu.:0.758         1st Qu.:3.000      \n Median :0.7899        Median :1.009         Median :5.000      \n Mean   :0.7987        Mean   :1.004         Mean   :4.915      \n 3rd Qu.:1.1474        3rd Qu.:1.253         3rd Qu.:7.000      \n Max.   :1.4993        Max.   :1.499         Max.   :9.000      \n Average_Load_Percentage     Profit       \n Min.   : 50.01          Min.   :-444584  \n 1st Qu.: 62.70          1st Qu.:  40885  \n Median : 75.50          Median : 262716  \n Mean   : 75.22          Mean   : 266219  \n 3rd Qu.: 87.72          3rd Qu.: 492216  \n Max.   :100.00          Max.   : 977168  \n```\n\n\n:::\n:::\n\n\n\n\n#### **3.2.2 Variable selection**\n\nTo perform an analysis to achieve the objectives aforementioned, the following variables will be selected.\n\n| Category   | Variable                | Recoded | Description | Type | Encoding |\n|------------|-------------------------|---------|-------------|------|----------|\n| Operation  | Date                    | bbb     | bbb         | bbb  | bbb      |\n| Ship       | Ship_Type               | bbb     | bbb         | bbb  | bbb      |\n| Operations | Route_Type              | bbb     | bbb         | bbb  | bbb      |\n| Ship       | Engine_Type             | bbb     | bbb         | bbb  | bbb      |\n| Ship       | Maintenance_Status      | bbb     | bbb         | bbb  | bbb      |\n| Ship       | Speed_Over_Ground_knots | bbb     | bbb         | bbb  | bbb      |\n| Ship       | Engine_Power_kW         | bbb     | bbb         | bbb  | bbb      |\n| Ship       | Distance_Traveled_nm    | bbb     | bbb         | bbb  | bbb      |\n| Operations | Weather_Condition       | bbb     | bbb         | bbb  | bbb      |\n| Operations | Cargo_Weight_tons       | bbb     | bbb         | bbb  | bbb      |\n| Business   | Operational_Cost_USD    | bbb     | bbb         | bbb  | bbb      |\n| Business   | Revenue_per_Voyage_USD  | bbb     | bbb         | bbb  | bbb      |\n| Ship       | Turnaround_Time_hours   | bbb     | bbb         | bbb  | bbb      |\n| Ship       | Efficiency_nm_per_kWh   | bbb     | bbb         | bbb  | bbb      |\n| Operations | Average_Load_Percentage | bbb     | bbb         | bbb  | bbb      |\n| Business   | Profit                  | bbb     | bbb         | bbb  | bbb      |\n\n: Variable Selection\\\n: {.striped .hover tbl-colwidths=\"\\[10,20,10,30,10,20\\]\"}\n\nThe code below is used to select and reorder columns of wanted variables using `select()`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nship <- data_ship %>%\n  \n  select(Date, Ship_Type, Route_Type, Engine_Type, Maintenance_Status, Speed_Over_Ground_knots,\n        Engine_Power_kW, Distance_Traveled_nm, Efficiency_nm_per_kWh,\n        Weather_Condition, Profit, Operational_Cost_USD, Revenue_per_Voyage_USD,  \n        Average_Load_Percentage, Cargo_Weight_tons, Turnaround_Time_hours) \n```\n:::\n\n\n\n\nUse `glimese()` to check and confirm the new data frame **ship** is created, and now has 16 columns.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(ship)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 2,736\nColumns: 16\n$ Date                    <date> 2023-06-04, 2023-06-11, 2023-06-18, 2023-06-2…\n$ Ship_Type               <chr> \"Container Ship\", \"Fish Carrier\", \"Container S…\n$ Route_Type              <chr> \"None\", \"Short-haul\", \"Long-haul\", \"Transocean…\n$ Engine_Type             <chr> \"Heavy Fuel Oil (HFO)\", \"Steam Turbine\", \"Dies…\n$ Maintenance_Status      <chr> \"Critical\", \"Good\", \"Fair\", \"Fair\", \"Fair\", \"F…\n$ Speed_Over_Ground_knots <dbl> 12.59756, 10.38758, 20.74975, 21.05510, 13.742…\n$ Engine_Power_kW         <dbl> 2062.9840, 1796.0574, 1648.5567, 915.2618, 108…\n$ Distance_Traveled_nm    <dbl> 1030.9436, 1060.4864, 658.8741, 1126.8225, 144…\n$ Efficiency_nm_per_kWh   <dbl> 1.4551789, 0.2903614, 0.4995945, 0.7029057, 1.…\n$ Weather_Condition       <chr> \"Moderate\", \"Rough\", \"Moderate\", \"Moderate\", \"…\n$ Profit                  <dbl> -191649.081, 400377.787, -54524.657, -173798.2…\n$ Operational_Cost_USD    <dbl> 483832.35, 483388.00, 448543.40, 261349.61, 28…\n$ Revenue_per_Voyage_USD  <dbl> 292183.27, 883765.79, 394018.75, 87551.38, 676…\n$ Average_Load_Percentage <dbl> 93.76925, 93.89537, 96.21824, 66.19370, 80.008…\n$ Cargo_Weight_tons       <dbl> 1959.0179, 162.3947, 178.0409, 1737.3853, 260.…\n$ Turnaround_Time_hours   <dbl> 25.86708, 63.24820, 49.41815, 22.40911, 64.158…\n```\n\n\n:::\n:::\n\n\n\n\n#### **3.2.3 Missing values**\n\nBefore I use the selected data to perform analysis, I want to check if there are missing values to remove. If an entry has a missing value, it may affect the analysis result.\n\n`is.na()` can be used to check this. Before I dive into each variable, I would like to have an overall check if there indeed are missing values. After this check, there is no missing value found.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwhich(is.na(ship))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ninteger(0)\n```\n\n\n:::\n\n```{.r .cell-code}\nsum(is.na(ship))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n\n\n\nWe see no missing values in numeric data. However, we observed some \"None\" values in the character data types: Ship_Type, Route_Type, Engine_Type, and Weather_Condition. Therefore, I will remove entries containing \"None\" using the code below. As a result, a tibble frame of 2,127 entries is derived.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n\n#check row numbers before filter\nnrow(ship)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2736\n```\n\n\n:::\n\n```{.r .cell-code}\nship_filter <- ship %>%\n  filter(!if_any(c(Ship_Type, Route_Type, Engine_Type, Weather_Condition, Maintenance_Status), ~ .x == \"None\"))\n\n#check row numbers after filter\nnrow(ship_filter) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2127\n```\n\n\n:::\n:::\n\n\n\n\n#### **3.2.4 Convert data type**\n\nFrom 3.2.2, I observed that Maintenance_Status, Weather_Condition, Ship_Type, Route_Type, Engine_Type are all character data type. In fact, Maintenance_Status, Weather_Condition can be converted to ordinal data type, and Ship_Type, Route_Type, Engine_Type to factor data type to derive better result.\n\nUse the code below to perform data type conversion:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncol_f <- c(\"Ship_Type\", \"Route_Type\", \"Engine_Type\", \"Weather_Condition\")\n#Column names should be in quotation marks (\" \")\n\nship_filter <- ship_filter %>%\n  mutate(across(col_f, as.factor)) %>%\n  mutate(Maintenance_Status = factor(Maintenance_Status,\n                                     levels = c(\"Good\", \"Fair\", \"Critical\"),\n                                     ordered = TRUE)) \n```\n:::\n\n\n\n\nI also want to convert the unit for the monetary values into thousand dollars as the unit for *Operational_Cost_USD, Revenue_per_Voyage_USD* and *Profit*.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nship_filter <- ship_filter %>%\n  mutate(Operational_Cost_USD = round(Operational_Cost_USD / 1000, 0), #convert to thousand dollars, leaving on decimal places.\n         Revenue_per_Voyage_USD = round(Revenue_per_Voyage_USD / 1000, 0),\n         Profit = round(Profit / 1000, 0))\n```\n:::\n\n\n\n\nI use `kable()` to check the conversion result, and confirm the desired variables have been converted accordingly.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(head(ship_filter, n=3), caption = \"Ship Performance Dataset\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Ship Performance Dataset\n\n|Date       |Ship_Type      |Route_Type   |Engine_Type   |Maintenance_Status | Speed_Over_Ground_knots| Engine_Power_kW| Distance_Traveled_nm| Efficiency_nm_per_kWh|Weather_Condition | Profit| Operational_Cost_USD| Revenue_per_Voyage_USD| Average_Load_Percentage| Cargo_Weight_tons| Turnaround_Time_hours|\n|:----------|:--------------|:------------|:-------------|:------------------|-----------------------:|---------------:|--------------------:|---------------------:|:-----------------|------:|--------------------:|----------------------:|-----------------------:|-----------------:|---------------------:|\n|2023-06-11 |Fish Carrier   |Short-haul   |Steam Turbine |Good               |                10.38758|       1796.0574|            1060.4864|             0.2903614|Rough             |    400|                  483|                    884|                93.89537|          162.3947|              63.24820|\n|2023-06-18 |Container Ship |Long-haul    |Diesel        |Fair               |                20.74975|       1648.5567|             658.8741|             0.4995945|Moderate          |    -55|                  449|                    394|                96.21824|          178.0409|              49.41815|\n|2023-06-25 |Bulk Carrier   |Transoceanic |Steam Turbine |Fair               |                21.05510|        915.2618|            1126.8225|             0.7029057|Moderate          |   -174|                  261|                     88|                66.19370|         1737.3853|              22.40911|\n\n\n:::\n:::\n\n\n\n\n## 4 Voyage Profile\n\nTo perform profit performance analysis in the next section, we shall understand the profile of the data and variables to determine the direction for the performance analysis. Below I will utilise variables to visualise ship conditions, weather conditions and operational factors by the different ship types to obtain some insights.\n\n### 4.1 Ship conditions & routes\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Code bar chart for Ship type\np_st <- ggplot(data = ship_filter,\n               aes(x = Ship_Type)) +\n  geom_bar(fill = \"grey20\") +\n  ylim(0, 1000) +\n  geom_text(stat=\"count\",\n            aes(label = paste0(after_stat(count),\", \",\n                               round(after_stat(count)/sum(after_stat(count))*100, 0), \"%\")),\n            vjust = -0.5,\n            size = 3) +\n  labs(x = \"\",\n       y = \"\",\n       title = \"Ship types\") +\n  theme_classic() +\n  theme(plot.background = element_rect(fill = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\"),\n        panel.border = element_blank(),\n        plot.title = element_text(size = 10, face = \"bold\"),\n        text = element_text(size = 10))\n\n# Code bar chart for Engine type\n\np_et <- ggplot(data = ship_filter,\n               aes(x = Engine_Type)) +\n  geom_bar(fill = \"grey20\") +\n  ylim(0, 1000) +\n  geom_text(stat=\"count\",\n            aes(label = paste0(after_stat(count),\", \",\n                               round(after_stat(count)/sum(after_stat(count))*100, 0), \"%\")),\n            vjust = -0.5,\n            size = 3) +\n  labs(x = \"\",\n       y = \"\",\n       title = \"Engine types\") +\n  theme_classic() +\n  theme(plot.background = element_rect(fill = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\"),\n        panel.border = element_blank(),\n        plot.title = element_text(size = 10, face = \"bold\"),\n        text = element_text(size = 10))\n\n\n# Code bar chart for Route type\n\np_rt <- ggplot(data = ship_filter,\n               aes(x = Route_Type)) +\n  geom_bar(fill = \"grey20\") +\n  ylim(0, 1000) +\n  geom_text(stat=\"count\",\n            aes(label = paste0(after_stat(count),\", \",\n                               round(after_stat(count)/sum(after_stat(count))*100, 0), \"%\")),\n            vjust = -0.5,\n            size = 3) +\n  labs(x = \"\",\n       y = \"\",\n       title = \"Route types\") +\n  theme_classic() +\n  theme(plot.background = element_rect(fill = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\"),\n        panel.border = element_blank(),\n        plot.title = element_text(size = 10, face = \"bold\"),\n        text = element_text(size = 10))\n\n#Code bar chart for Maintenance status\n\np_ms <- ggplot(data = ship_filter,\n               aes(x = Maintenance_Status)) +\n  geom_bar(fill = \"grey20\") +\n  ylim(0, 1000) +\n  geom_text(stat=\"count\",\n            aes(label = paste0(after_stat(count),\", \",\n                               round(after_stat(count)/sum(after_stat(count))*100, 0), \"%\")),\n            vjust = -0.5,\n            size = 3) +\n  labs(x = \"\",\n       y = \"\",\n       title = \"Maintenance status\") +\n  theme_classic() +\n  theme(plot.background = element_rect(fill = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\"),\n        panel.border = element_blank(),\n        plot.title = element_text(size = 10, face = \"bold\"),\n        text = element_text(size = 10))\n\n#Combine all charts\n\npatchwork <- (p_st | p_et) / (p_rt | p_ms)\npatchwork\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-14-1.png){width=768}\n:::\n:::\n\n\n\n\n::::: spgoals\n::: spgoals-header\nInsights\n:::\n\n::: spgoals-container\n-   text\n:::\n:::::\n\n### 4.2 Weather conditions\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n#Plot1\np_wthr_1 <- ggplot(data = ship_filter,\n               aes(x = Weather_Condition, fill = Weather_Condition)) +\n  geom_bar() +\n  ylim(0, 1000) +\n  geom_text(stat=\"count\",\n            aes(label = paste0(after_stat(count),\", \",\n                               round(after_stat(count)/sum(after_stat(count))*100, 0), \"%\")),\n            vjust = -0.5,\n            size = 3) +\n  scale_fill_manual(values = c(\"Calm\" = \"#bcd6be\",\n                               \"Moderate\" = \"#f5e8ce\",\n                               \"Rough\" = \"#e0bcc0\")) +\n  labs(x = \"\",\n       y = \"\",\n       title = \"Weather Condition \\n Overview\") +\n  theme_light() +\n  theme(plot.background = element_rect(fill = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\"),\n        panel.border = element_blank(),\n        plot.title = element_text(size = 12, face = \"bold\"),\n        text = element_text(size = 8),\n        legend.text = element_text(size = 8),  \n        legend.title = element_text(size = 8, face = \"bold\"),  \n#        legend.key.size = unit(0.5, \"cm\"),  \n#        legend.spacing.y = unit(0.3, \"cm\"),\n        legend.position = \"none\")  \n\n# Plot2\n# Extract month and year from the Date\nship_filter_month <- ship_filter %>%\n  mutate(Month = floor_date(Date, \"month\"))\n\n# Group by Month and Weather type, then count occurrences\nweather_by_month_bar <- ship_filter_month %>%\n  group_by(Month, Weather_Condition) %>%\n  summarise(Count = n(), .groups = \"drop\")\n\n# Calculate total occurrences per month\ntotal_per_month_bar <- weather_by_month_bar %>%\n  group_by(Month) %>%\n  summarise(Total = sum(Count))\n\n# Join total occurrences per month and compute percentage\nweather_percentage_bar <- weather_by_month_bar %>%\n  left_join(total_per_month_bar, by = \"Month\") %>%\n  mutate(Percentage = (Count / Total) * 100) \n\n# Plot stacked bar chart with percentage\np_wthr_2 <- ggplot(weather_percentage_bar, \n       aes(x = Month, y = Percentage, fill = factor(Weather_Condition, levels = c(\"Calm\", \"Moderate\", \"Rough\")))) +\n  geom_bar(stat = \"identity\", position = \"stack\") +  # Use identity because we computed percentages\n  geom_text(aes(label = paste0(round(Percentage, 0), \"%\")), \n            position = position_stack(vjust = 0.5),  \n            size = 3, color = \"black\") +  \n  scale_fill_manual(values = c(\"Calm\" = \"#bcd6be\",\n                               \"Moderate\" = \"#f5e8ce\",\n                               \"Rough\" = \"#e0bcc0\")) + \n  labs(title = \"Weather Distribution by Month (%)\",\n       x = \"Month\",\n       y = \"Percentage (%)\",\n       fill = \"Weather\") +\n  theme_light() +\n  scale_x_date(labels = scales::date_format(\"%m/%y\"), breaks = \"1 month\") + \n  theme(plot.title = element_text(size = 12, face = \"bold\"),\n        plot.background = element_rect(fill = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\"),\n        panel.border = element_blank(),\n        text = element_text(size = 8),\n        legend.text = element_text(size = 8),  \n        legend.title = element_text(size = 8, face = \"bold\"), \n        legend.key.size = unit(0.5, \"cm\"),  \n        legend.spacing.y = unit(0.3, \"cm\"),\n        legend.position = \"top\")  \n\n#Combine plots\np_wthr_2 + p_wthr_1 + plot_layout(widths = c(2.5,1))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-15-1.png){width=960}\n:::\n:::\n\n\n\n\n::::: spgoals\n::: spgoals-header\nInsights\n:::\n\n::: spgoals-container\n-   text\n:::\n:::::\n\n### 4.3 Operational effects by ship type\n\n::: panel-tabset\n## **Average load**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n#Plot1\np_heye_al <- ggplot(ship_filter,\n       aes(x = Ship_Type,\n           y = Average_Load_Percentage,\n           fill = Route_Type)) +\n  ggdist::stat_halfeye(.width=c(0,1), adjust = .5,\n                       shape = 21,\n                       point_size = 2,\n                       interval_color = \"grey60\") +\n  scale_fill_manual(values = c(\"Coastal\" = adjustcolor(\"#FF9EAA\", alpha.f = 0.5),\n                               \"Long-haul\" = adjustcolor(\"#3AA6B9\", alpha.f = 0.5), \n                               \"Short-haul\" = adjustcolor(\"#e0c080\", alpha.f = 0.5),\n                               \"Transoceanic\" = adjustcolor(\"grey70\", alpha.f = 0.5)),\n                               name = NULL) +\n  labs(title = \"Halfeye Plots by Route Type\")\n\n\n#Plot2\n\nmedian_load = median(ship_filter$Average_Load_Percentage)\n\np_heye_al_st <- ggplot(ship_filter,\n       aes(x = Ship_Type,\n           y = Average_Load_Percentage)) +\n  ggdist::stat_interval(.width = 1:4*.25) +\n  ggdist::stat_halfeye(.width = 0, fill = \"grey60\", color = \"white\", position = position_nudge(x = .024)) +\n  scale_color_viridis_d(option = \"mako\", direction = -1, end = .9) +\n  geom_hline(yintercept = median_load, linetype = \"dashed\", color = \"#3AA6B9\") +  # Add median line\n  annotate(\"text\", x = 1.2, y = median_load, label = paste(\"Median:\", round(median_load, 2)),\n            color = \"#3AA6B9\", vjust = -1, hjust = 0, size = 3) +  # Add text label\n  labs(title = \"Halfeye Plots with Median Line\")\n\n#Combine plots\np_heye_al_st / p_heye_al + plot_layout(height = c(1, 1.5))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-16-1.png){width=864}\n:::\n:::\n\n\n\n\n## **Engine power**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n#Plot1\np_heye_ep <- ggplot(ship_filter,\n       aes(x = Ship_Type,\n           y = Engine_Power_kW,\n           fill = Route_Type)) +\n  ggdist::stat_halfeye(.width=c(0,1), adjust = .5,\n                       shape = 21,\n                       point_size = 2) +\n  scale_fill_manual(values = c(\"Coastal\" = adjustcolor(\"#FF9EAA\", alpha.f = 0.5),\n                               \"Long-haul\" = adjustcolor(\"#3AA6B9\", alpha.f = 0.5), \n                               \"Short-haul\" = adjustcolor(\"#e0c080\", alpha.f = 0.5),\n                               \"Transoceanic\" = adjustcolor(\"grey70\", alpha.f = 0.5)), \n                                 name = NULL) +\n  \n  labs(title = \"Halfeye Plots of Engine Power by Route Type\")\n\n\n#Plot2\n\nmedian_load = median(ship_filter$Engine_Power_kW)\n\np_heye_ep_st <- ggplot(ship_filter,\n       aes(x = Ship_Type,\n           y = Engine_Power_kW)) +\n  ggdist::stat_interval(.width = 1:4*.25) +\n  ggdist::stat_halfeye(.width = 0, fill = \"grey80\", color = \"white\", position = position_nudge(x = .024)) +\n  scale_color_viridis_d(option = \"cividis\", direction = -1, end = .9) +\n  geom_hline(yintercept = median_load, linetype = \"dashed\", color = \"blue\") +  # Add median line\n  annotate(\"text\", x = 1.2, y = median_load, label = paste(\"Median:\", round(median_load, 2)),\n            color = \"blue\", vjust = -1, hjust = 0, size = 3) +  # Add text label\n  labs(title = \"Halfeye Plots of Engine Power with Median Line\")\n\n#Combine plots\np_heye_ep_st / p_heye_ep + plot_layout(height = c(1, 1.5))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-17-1.png){width=864}\n:::\n:::\n\n\n\n\n## **Cargo weight**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n#Plot1\np_heye_cw <- ggplot(ship_filter,\n       aes(x = Ship_Type,\n           y = Cargo_Weight_tons,\n           fill = Route_Type)) +\n  ggdist::stat_halfeye(.width=c(0,1), adjust = .5,\n                       shape = 21,\n                       point_size = 2) +\n  scale_fill_manual(values = c(\"Coastal\" = adjustcolor(\"#FF9EAA\", alpha.f = 0.5),\n                               \"Long-haul\" = adjustcolor(\"#3AA6B9\", alpha.f = 0.5), \n                               \"Short-haul\" = adjustcolor(\"#e0c080\", alpha.f = 0.5),\n                               \"Transoceanic\" = adjustcolor(\"grey70\", alpha.f = 0.5)), \n                               name = NULL) +\n  labs(title = \"Halfeye Plots of Cargo Weight by Route Type\")\n\n\n#Plot2\n\nmedian_load = median(ship_filter$Cargo_Weight_tons)\n\np_heye_cw_st <- ggplot(ship_filter,\n       aes(x = Ship_Type,\n           y = Cargo_Weight_tons)) +\n  ggdist::stat_interval(.width = 1:4*.25) +\n  ggdist::stat_halfeye(.width = 0, fill = \"grey80\", color = \"white\", position = position_nudge(x = .024)) +\n  scale_color_viridis_d(option = \"plasma\", direction = -1, end = .9) +\n  geom_hline(yintercept = median_load, linetype = \"dashed\", color = \"red\") +  # Add median line\n  annotate(\"text\", x = 1.2, y = median_load, label = paste(\"Median:\", round(median_load, 2)),\n            color = \"red\", vjust = -1, hjust = 0, size = 3) +  # Add text label\n  labs(title = \"Halfeye Plots of Cargo Weight with Median Line\")\n\n#Combine plots\np_heye_cw_st / p_heye_cw + plot_layout(height = c(1, 1.5))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-18-1.png){width=864}\n:::\n:::\n\n\n\n\n## **Turnaround time**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n#Plot1\np_heye_tt <- ggplot(ship_filter,\n       aes(x = Ship_Type,\n           y = Turnaround_Time_hours,\n           fill = Route_Type)) +\n  ggdist::stat_halfeye(.width=c(0,1), adjust = .5,\n                       shape = 21,\n                       point_size = 2) +\n  scale_fill_manual(values = c(\"Coastal\" = adjustcolor(\"#FF9EAA\", alpha.f = 0.5),\n                               \"Long-haul\" = adjustcolor(\"#3AA6B9\", alpha.f = 0.5), \n                               \"Short-haul\" = adjustcolor(\"#e0c080\", alpha.f = 0.5),\n                               \"Transoceanic\" = adjustcolor(\"grey70\", alpha.f = 0.5)), \n                               name = NULL) +\n  labs(title = \"Halfeye Plots of Turnaround Time by Route Type\")\n\n\n#Plot2\n\nmedian_load = median(ship_filter$Turnaround_Time_hours)\n\np_heye_tt_st <- ggplot(ship_filter,\n       aes(x = Ship_Type,\n           y = Turnaround_Time_hours)) +\n  ggdist::stat_interval(.width = 1:4*.25) +\n  ggdist::stat_halfeye(.width = 0, fill = \"grey80\", color = \"white\", position = position_nudge(x = .024)) +\n  scale_color_viridis_d(option = \"rocket\", direction = -1, end = .9) +\n  geom_hline(yintercept = median_load, linetype = \"dashed\", color = \"green\") +  # Add median line\n  annotate(\"text\", x = 1.2, y = median_load, label = paste(\"Median:\", round(median_load, 2)),\n            color = \"green\", vjust = -1, hjust = 0, size = 3) +  # Add text label\n  labs(title = \"Halfeye Plots of Turnaround Time with Median Line\")\n\n#Combine plots\np_heye_tt_st / p_heye_tt + plot_layout(height = c(1, 1.5))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-19-1.png){width=864}\n:::\n:::\n\n\n\n\n## **Distance travelled**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n#Plot1\np_heye_dt <- ggplot(ship_filter,\n       aes(x = Ship_Type,\n           y = Distance_Traveled_nm,\n           fill = Route_Type)) +\n  ggdist::stat_halfeye(.width=c(0,1), adjust = .5,\n                       shape = 21,\n                       point_size = 2) +\n  scale_fill_manual(values = c(\"Coastal\" = adjustcolor(\"#FF9EAA\", alpha.f = 0.5),\n                               \"Long-haul\" = adjustcolor(\"#3AA6B9\", alpha.f = 0.5), \n                               \"Short-haul\" = adjustcolor(\"#e0c080\", alpha.f = 0.5),\n                               \"Transoceanic\" = adjustcolor(\"grey70\", alpha.f = 0.5)), \n                               name = NULL) +\n  labs(title = \"Halfeye Plots of Distance by Route Type\")\n\n\n#Plot2\n\nmedian_load = median(ship_filter$Distance_Traveled_nm)\n\np_heye_dt_st <- ggplot(ship_filter,\n       aes(x = Ship_Type,\n           y = Distance_Traveled_nm)) +\n  ggdist::stat_interval(.width = 1:4*.25) +\n  ggdist::stat_halfeye(.width = 0, fill = \"grey80\", color = \"white\", position = position_nudge(x = .024)) +\n  scale_color_viridis_d(option = \"inferno\", direction = -1, end = .9) +\n  geom_hline(yintercept = median_load, linetype = \"dashed\", color = \"grey20\") +  # Add median line\n  annotate(\"text\", x = 1.2, y = median_load, label = paste(\"Median:\", round(median_load, 2)),\n            color = \"grey20\", vjust = -1, hjust = 0, size = 3) +  # Add text label\n  labs(title = \"Halfeye Plots of Distance with Median Line\")\n\n#Combine plots\np_heye_dt_st / p_heye_dt + plot_layout(height = c(1, 1.5))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-20-1.png){width=864}\n:::\n:::\n\n\n\n\n## **Energy efficiency**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Plot1\np_heye_ee_et <- ggplot(ship_filter,\n       aes(x = Ship_Type,\n           y = Efficiency_nm_per_kWh,\n           fill = Engine_Type)) +\n  ggdist::stat_halfeye(.width=c(0,1), adjust = .5,\n                       shape = 21,\n                       point_size = 2) +\n  scale_fill_manual(values = c(\"Heavy Fuel Oil (HFO)\" = adjustcolor(\"#F9DBBA\", alpha.f = 0.6),\n                               \"Steam Turbine\" = adjustcolor(\"#DA498D\", alpha.f = 0.6), \n                               \"Diesel\" = adjustcolor(\"#96CEB4\", alpha.f = 0.6),\n                               name = NULL)) +\n  labs(title = \"Halfeye Plots of Energy Efficiency by Engine Type\")\n\n\n# Plot2\n\nmedian_load = median(ship_filter$Efficiency_nm_per_kWh)\n\np_heye_ee <- ggplot(ship_filter,\n       aes(x = Ship_Type,\n           y = Efficiency_nm_per_kWh)) +\n  ggdist::stat_interval(.width = 1:4*.25) +\n  ggdist::stat_halfeye(.width = 0, fill = \"grey80\", color = \"white\", position = position_nudge(x = .024)) +\n  scale_color_viridis_d(option = \"magma\", direction = -1, end = .9) +\n  geom_hline(yintercept = median_load, linetype = \"dashed\", color = \"brown\") +  # Add median line\n  annotate(\"text\", x = 1.2, y = median_load, label = paste(\"Median:\", round(median_load, 2)),\n            color = \"brown\", vjust = -1, hjust = 0, size = 3) +  # Add text label\n  labs(title = \"Halfeye Plots of Energy Efficiency with Median Line\")\n\n# Plot3\np_heye_ee_wc <- ggplot(ship_filter,\n       aes(x = Ship_Type,\n           y = Efficiency_nm_per_kWh,\n           fill = Weather_Condition)) +\n  ggdist::stat_halfeye(.width=c(0,1), adjust = .5,\n                       shape = 21,\n                       point_size = 3) +\n  scale_fill_manual(values = c(\"Moderate\" = adjustcolor(\"#F9DBBA\", alpha.f = 0.6),\n                               \"Rough\" = adjustcolor(\"#DA498D\", alpha.f = 0.6), \n                               \"Calm\" = adjustcolor(\"#5B99C2\", alpha.f = 0.6),\n                               name = NULL)) +\n  labs(title = \"Halfeye Plots of Energy Efficiency by Weather\")\n\n# Plot4\np_heye_ee_ms <- ggplot(ship_filter,\n       aes(x = Ship_Type,\n           y = Efficiency_nm_per_kWh,\n           fill = Maintenance_Status)) +\n  ggdist::stat_halfeye(.width=c(0,1), adjust = .5,\n                       shape = 21,\n                       point_size = 2) +\n  scale_fill_manual(values = c(\"Fair\" = adjustcolor(\"#F9DBBA\", alpha.f = 0.6),\n                               \"Critical\" = adjustcolor(\"#8B5DFF\", alpha.f = 0.6), \n                               \"Good\" = adjustcolor(\"#41B3A2\", alpha.f = 0.6),\n                               name = NULL)) +\n  labs(title = \"Halfeye Plots of Energy Efficiency by Maintenance\")\n\n\n# Combine plots\n(p_heye_ee | p_heye_ee_et) / (p_heye_ee_wc | p_heye_ee_ms)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-21-1.png){width=1344}\n:::\n:::\n\n\n\n:::\n\n::::: spgoals\n::: spgoals-header\nInsights\n:::\n\n::: spgoals-container\n-   text\n:::\n:::::\n\n### 4.4 Voyage frequency\n\n#### **4.4.1 Overall voyage frequency over time**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nvoyage_count <- ship_filter %>%\n  mutate(Month = format(as.Date(Date), \"%Y-%m\")) %>% #to extract Year-Month\n  group_by(Month) %>%\n  summarise(Count = n()) #count rows\nvoyage_count_scaled <- voyage_count %>%\n  mutate(Count_scaled = Count / 10)\n\n#calculate average\nmean_voyage <- mean(voyage_count$Count)\n\nggplot(voyage_count_scaled,\n       aes(x = Month,\n           y = Count_scaled)) +\n  geom_bar(stat = \"identity\", \n           fill = \"grey30\") +\n  labs(x = \"Date\", y = \"Voyage Count (scaled by 10) \",\n       title = \"Voyage Frequency Over Time\") +\n  theme_classic() +\n  geom_hline(yintercept = mean_voyage/10, color = \"#3AA6B9\", linetype = \"dashed\", size = 1) + \n  annotate(\"text\", x = 3.2, y = mean_voyage/10 + 1, \n           label = paste(\"Mean: \", round(mean_voyage/10, 2)), color = \"#3AA6B9\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-22-1.png){width=768}\n:::\n:::\n\n\n\n\n::::: spgoals\n::: spgoals-header\nInsights\n:::\n\n::: spgoals-container\n-   text\n:::\n:::::\n\n#### **4.4.2 Voyage frequency by ship type**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Extract month and year from the Date\nship_filter_month <- ship_filter %>%\n  mutate(Month = floor_date(Date, \"month\"))\n\n# Group by Month and Ship type, then count occurrences\ntrip_by_month_bar <- ship_filter_month %>%\n  group_by(Month, Ship_Type) %>%\n  summarise(Count = n(), .groups = \"drop\")\n\n# Calculate total occurrences per month\ntotal_trip_per_month_bar <- trip_by_month_bar %>%\n  group_by(Month) %>%\n  summarise(Total = sum(Count))\n\n# Join total occurrences per month and compute percentage\ntrip_percentage_bar <- trip_by_month_bar %>%\n  left_join(total_trip_per_month_bar, by = \"Month\") %>%\n  mutate(Percentage = (Count / Total) * 100)  # Convert to percentage\n\n# Plot stacked bar chart with percentage\np_trip_ct_1 <- ggplot(trip_percentage_bar, \n       aes(x = Month, y = Percentage, fill = factor(Ship_Type, levels = c(\"Bulk Carrier\", \"Container Ship\", \"Fish Carrier\", \"Tanker\")))) +\n  geom_bar(stat = \"identity\", position = \"stack\") +  # Use identity because we computed percentages\n  geom_text(aes(label = paste0(round(Percentage, 0), \"%\")), \n            position = position_stack(vjust = 0.5),  # Center the text in each segment\n            size = 2.5, color = \"black\") +  # Adjust text size and color\n  scale_fill_manual(values = c(\"Bulk Carrier\" = \"#bcd6be\",\n                               \"Container Ship\" = \"#f5e8ce\",\n                               \"Fish Carrier\" = \"#e0bcc0\",\n                               \"Tanker\" = \"#9bc5cc\")) + \n  labs(title = \"Number of Trips Over Time (%)\",\n       x = \"Month\",\n       y = \"Percentage (%)\",\n       fill = \"Ship_Type\") +\n  theme_light() +\n  scale_x_date(labels = scales::date_format(\"%m/%y\"), breaks = \"1 month\") + \n  theme(plot.title = element_text(size = 8, face = \"bold\"),\n        plot.background = element_rect(fill = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\"),\n        panel.border = element_blank(),\n        text = element_text(size = 8),\n        legend.text = element_text(size = 6),  # Change legend text size\n        legend.title = element_text(size = 6, face = \"bold\"),  # Change legend title size\n        legend.key.size = unit(0.5, \"cm\"),  # Adjust legend key size (box size)\n        legend.spacing.y = unit(0.3, \"cm\"),\n        legend.position = \"top\") \n\n###------------ Plot2 ------------###\n#Count the number of trips by ship\ntrip_count <- ship_filter %>%\n  group_by(Ship_Type) %>%\n  summarise(Trip_Count = n(), .group = \"drop\")\n\n#calculation\ntotal_trips <- sum(trip_count$Trip_Count)\ntrip_count <- trip_count %>%\n  mutate(Percentage = (Trip_Count / total_trips) * 100)\n\n#plot the bar chart\np_trip_ct_2 <- ggplot(trip_count,\n       aes(x = Ship_Type,\n           y = Trip_Count,\n           fill = Ship_Type)) +\n  geom_bar(stat = \"identity\", show.legend = FALSE) + #stat = \"identity\": use the values in 'Trip_Count'\n  labs(title = \"Trip Count by Ship Type\",\n       x = \"Ship Type\",\n       y = \"Number of Trips\") +\n  geom_text(aes(label = paste0(Trip_Count,\" (\", round(Percentage, 1), \"%)\")),\n            vjust = -0.8, size = 2, angle = 45) +\n  theme_light() +\n  theme(plot.title = element_text(size = 8, face = \"bold\"),\n        plot.background = element_rect(fill = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\"),\n        panel.border = element_blank(),\n        text = element_text(size = 8),\n        legend.text = element_text(size = 6), \n        legend.title = element_text(size = 6, face = \"bold\"), \n        legend.key.size = unit(0.5, \"cm\"),\n        legend.spacing.y = unit(0.3, \"cm\"),\n        legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, hjust = 1)) +\n  scale_fill_manual(values = c(\"Bulk Carrier\" = \"#bcd6be\",\n                               \"Container Ship\" = \"#f5e8ce\",\n                               \"Fish Carrier\" = \"#e0bcc0\",\n                               \"Tanker\" = \"#9bc5cc\")) \n#Combine plots\np_trip_ct_1 + p_trip_ct_2 + plot_layout(widths = c(2.5,1))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-23-1.png){width=768}\n:::\n:::\n\n\n\n\n::::: spgoals\n::: spgoals-header\nInsights\n:::\n\n::: spgoals-container\n-   text\n:::\n:::::\n\n## 5 Profit Performance\n\n### 5.1 Finance performance overview\n\nTo have an overview of the finance performance from all ship types, I use boxplot to check the operational cost, revenue per trip and the profit in thousand dollars. There are no outliers observed. The operational cost does not expand beyond \\$500K\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n#Plot operational cost distribution\np1 <- ggplot(ship_filter,\n       aes(y = Operational_Cost_USD, x = \"All ship types\")) +\n  geom_violin(outlier.colour = \"purple\",\n              color = \"#A3B23B\",\n              fill = \"#F4F8D3\",\n              alpha = 0.4) + \n  geom_boxplot(width = .2,\n               color = \"grey60\") +\n  geom_point(position = \"jitter\",\n             size = 0.2,\n             color = \"#F4F8D3\",\n             alpha = 0.3) +\n  coord_cartesian(ylim = c(-500, 1000)) +\n  theme_light() +\n  theme(plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        panel.border = element_blank())\n\n#Plot revenue distribution\np2<- ggplot(ship_filter,\n       aes(y = Revenue_per_Voyage_USD, x = \"All ship types\")) +\n  geom_violin(outlier.colour = \"blue\",\n               color = \"#5FB0B0\",\n               fill = \"#73C7C7\",\n               alpha = 0.4) +\n  geom_boxplot(width = .2,\n               color = \"grey60\") +\n  geom_point(position = \"jitter\",\n             size = 0.2,\n             color = \"#73C7C7\",\n             alpha = 0.3) +\n  coord_cartesian(ylim = c(-500, 1000)) +\n  theme_light() +\n  theme(plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        panel.border = element_blank())\n\n#Plot profit distribution\np3 <- ggplot(ship_filter,\n       aes(y = Profit, x = \"All ship types\")) +\n  geom_violin(outlier.colour = \"green\",\n               color = \"#E6A5B1\",\n               fill = \"#F7CFD8\",\n               alpha = 0.4) +\n  geom_boxplot(width = .2,\n               color = \"grey60\") +\n  geom_point(position = \"jitter\",\n             size = 0.2,\n             color = \"#F7CFD8\",\n             alpha = 0.3) +\n  coord_cartesian(ylim = c(-500, 1000)) +\n  theme_light() +\n  theme(plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        panel.border = element_blank())\n\npatchwork <- p1 + p2 + p3\npatchwork + plot_annotation(\n  title = \"Finance Distribution Overview\") &\n  theme(plot.title = element_text(size = 12, face = \"bold\"),\n        plot.background = element_rect(fill = \"#f1f4f5\", color = NA)\n)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n\nWelch’s one-way ANOVA\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Plot statboxplot by ship types\nggbetweenstats(\n  data = ship_filter,\n  x = Ship_Type,\n  y = Profit,\n  type = \"p\",\n  mean.ci = TRUE,\n  pariwise.comparisons = TRUE,\n  pairwise.display = \"s\",\n  p.adjust.methods = \"fdr\",\n  message = FALSE\n) +\n  theme(panel.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        plot.background = element_rect(fill = \"#f1f4f5\", color = NA))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n\n\n::::: spgoals\n::: spgoals-header\nInsights\n:::\n\n::: spgoals-container\n-   text\n:::\n:::::\n\n### 5.2 Profit performance with different factors by ship type\n\nIn this section, I will explore more variables by Ship types to assess ships performance in different aspects.\n\n#### **5.2.1 Operational conditions**\n\n::: panel-tabset\n## **Route Type**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n###------------1 Plot Bulk Carrier -----------###\n\n# Filter data for only \"Bulk Carrier\" ships\nbulkc_data <- ship_filter %>%\n  filter(Ship_Type == \"Bulk Carrier\")\n\n# Calculate mean profit for each Engine Type and Route Type\nmean_profit_bulkc <- bulkc_data %>%\n  group_by(Engine_Type, Route_Type) %>%\n  summarise(mean_profit_bulkc = mean(Profit, na.rm = TRUE), .groups = \"drop\")\n\n# Create Plot_bulkc\np_ridg_bulkc <- ggplot(bulkc_data, aes(x = Profit, \n                        y = Engine_Type, \n                        fill = Route_Type, \n                        color = Route_Type)) +\n  geom_density_ridges(\n    alpha = 0.2,           \n    scale = 6,            \n    rel_min_height = 0.01,\n    position = \"identity\"   # Ensures full overlap\n  ) +\n  geom_point(data = mean_profit_bulkc, \n             aes(x = mean_profit_bulkc, y = Engine_Type, fill = Route_Type), \n             shape = 23, size = 3, stroke = 0.5, color = \"grey90\") +\n  facet_wrap(~ Engine_Type, ncol = 1) +\n  labs(x = \"Bulk Carrier\", y = NULL) +  \n  scale_fill_manual(values = c(\"Coastal\" = \"#FF9EAA\",\n                               \"Long-haul\" = \"#3AA6B9\",\n                               \"Short-haul\" = \"#e0c080\",\n                               \"Transoceanic\" = \"grey70\")) +  \n  scale_color_manual(values = c(\"Coastal\" = \"#FF9EAA\",\n                               \"Long-haul\" = \"#3AA6B9\",\n                               \"Short-haul\" = \"#e0c080\",\n                               \"Transoceanic\" = \"grey70\")) + \n  theme_classic() +\n  theme(axis.text.y = element_blank(),  \n        axis.ticks.y = element_blank(),\n        axis.line.y = element_blank(),\n        panel.grid.major = element_blank(),  \n        panel.grid.minor = element_blank(),\n        strip.text.y = element_blank(),\n        strip.background = element_blank(), \n        legend.position = \"none\",\n        plot.title = element_text(size = 12, face = \"bold\",\n                                  hjust = 0.5, vjust = -120),\n        panel.spacing = unit(1, \"lines\"),\n        plot.margin = margin(t = 10, r = 10, b = 30, l = 20)\n        ) \n\n\n###------------2 Plot Container Ship -----------###\n# Filter data for only \"Container Ship\" ships\ncship_data <- ship_filter %>%\n  filter(Ship_Type == \"Container Ship\")\n\n# Calculate mean profit for each Engine Type and Route Type\nmean_profit_cship <- cship_data %>%\n  group_by(Engine_Type, Route_Type) %>%\n  summarise(mean_profit_cship = mean(Profit, na.rm = TRUE), .groups = \"drop\")\n\n# Create Plot_cship\np_ridg_cship <- ggplot(cship_data, aes(x = Profit, \n                        y = Engine_Type, \n                        fill = Route_Type, \n                        color = Route_Type)) +\n  geom_density_ridges(\n    alpha = 0.2,           \n    scale = 6,            \n    rel_min_height = 0.01,\n    position = \"identity\"   # Ensures full overlap\n  ) +\n  geom_point(data = mean_profit_cship, \n             aes(x = mean_profit_cship, y = Engine_Type, fill = Route_Type), \n             shape = 23, size = 3, stroke = 0.5, color = \"grey90\") +\n  facet_wrap(~ Engine_Type, ncol = 1, strip.position = \"left\") + \n  labs(x = \"Container Ship\", y = NULL) +  \n  scale_fill_manual(values = c(\"Coastal\" = \"#FF9EAA\",\n                               \"Long-haul\" = \"#3AA6B9\",\n                               \"Short-haul\" = \"#e0c080\",\n                               \"Transoceanic\" = \"grey70\")) +  \n  scale_color_manual(values = c(\"Coastal\" = \"#FF9EAA\",\n                               \"Long-haul\" = \"#3AA6B9\",\n                               \"Short-haul\" = \"#e0c080\",\n                               \"Transoceanic\" = \"grey70\")) + \n  theme_classic() +\n  theme(axis.text.y = element_blank(),  \n        axis.ticks.y = element_blank(),\n        axis.line.y = element_blank(),\n        panel.grid.major = element_blank(),  \n        panel.grid.minor = element_blank(),\n        strip.text.y = element_blank(),\n        strip.background = element_blank(), \n        legend.position = \"top\",\n        plot.title = element_text(size = 12, face = \"bold\",\n                                  hjust = 0.5, vjust = -120),\n        panel.spacing = unit(1, \"lines\")\n        )\n\n\n###-----------3 Plot Fish Carrier -----------###\n# Filter data for only \"Fish Carrier\" ships\nfishc_data <- ship_filter %>%\n  filter(Ship_Type == \"Fish Carrier\")\n\n# Calculate mean profit for each Engine Type and Route Type\nmean_profit_fishc <- fishc_data %>%\n  group_by(Engine_Type, Route_Type) %>%\n  summarise(mean_profit_fishc = mean(Profit, na.rm = TRUE), .groups = \"drop\")\n\n# Create Plot_fishc\np_ridg_fishc <- ggplot(fishc_data, aes(x = Profit, \n                        y = Engine_Type, \n                        fill = Route_Type, \n                        color = Route_Type)) +\n  geom_density_ridges(\n    alpha = 0.2,           \n    scale = 6,            \n    rel_min_height = 0.01,\n    position = \"identity\"   # Ensures full overlap\n  ) +\n  geom_point(data = mean_profit_fishc, \n             aes(x = mean_profit_fishc, y = Engine_Type, fill = Route_Type), \n             shape = 23, size = 3, stroke = 0.5, color = \"grey90\") +\n  facet_wrap(~ Engine_Type, ncol = 1, strip.position = \"left\") +  # Separate plots for each Route_Type\n  labs(x = \"Fish Carrier\", y = NULL) +  \n  scale_fill_manual(values = c(\"Coastal\" = \"#FF9EAA\",\n                               \"Long-haul\" = \"#3AA6B9\",\n                               \"Short-haul\" = \"#e0c080\",\n                               \"Transoceanic\" = \"grey70\")) +  \n  scale_color_manual(values = c(\"Coastal\" = \"#FF9EAA\",\n                               \"Long-haul\" = \"#3AA6B9\",\n                               \"Short-haul\" = \"#e0c080\",\n                               \"Transoceanic\" = \"grey70\")) + \n  theme_classic() +\n  theme(axis.text.y = element_blank(),  \n        axis.ticks.y = element_blank(),\n        axis.line.y = element_blank(),\n        panel.grid.major = element_blank(),  \n        panel.grid.minor = element_blank(),\n        strip.text.y = element_blank(),\n        strip.background = element_blank(), \n        legend.position = \"none\",\n        plot.title = element_text(size = 12, face = \"bold\",\n                                  hjust = 0.5, vjust = -120),\n        panel.spacing = unit(1, \"lines\")\n        )\n\n###-----------4 Plot Tanker-----------###\n# Filter data for only \"Tanker\" ships\ntanker_data <- ship_filter %>%\n  filter(Ship_Type == \"Tanker\")\n\n# Calculate mean profit for each Engine Type and Route Type\nmean_profit_tanker <- tanker_data %>%\n  group_by(Engine_Type, Route_Type) %>%\n  summarise(mean_profit_tanker = mean(Profit, na.rm = TRUE), .groups = \"drop\")\n\n# Create Plot_tanker\np_ridg_tanker <- ggplot(tanker_data, aes(x = Profit, \n                        y = Engine_Type, \n                        fill = Route_Type, \n                        color = Route_Type)) +\n  geom_density_ridges(\n    alpha = 0.2,           \n    scale = 6,            \n    rel_min_height = 0.01,\n    position = \"identity\"   # Ensures full overlap\n  ) +\n  geom_point(data = mean_profit_tanker, \n             aes(x = mean_profit_tanker, y = Engine_Type, fill = Route_Type), \n             shape = 23, size = 3, stroke = 0.5, color = \"grey90\") +\n  facet_wrap(~ Engine_Type, ncol = 1, strip.position = \"left\") +  # Separate plots for each Route_Type\n  labs(x = \"Tanker\", y = NULL) +  \n  scale_fill_manual(values = c(\"Coastal\" = \"#FF9EAA\",\n                               \"Long-haul\" = \"#3AA6B9\",\n                               \"Short-haul\" = \"#e0c080\",\n                               \"Transoceanic\" = \"grey70\")) +  \n  scale_color_manual(values = c(\"Coastal\" = \"#FF9EAA\",\n                               \"Long-haul\" = \"#3AA6B9\",\n                               \"Short-haul\" = \"#e0c080\",\n                               \"Transoceanic\" = \"grey70\")) + \n  theme_classic() +\n  theme(axis.text.y = element_blank(),  \n        axis.ticks.y = element_blank(),\n        axis.line.y = element_blank(),\n        panel.grid.major = element_blank(),  \n        panel.grid.minor = element_blank(),\n        strip.text.y = element_blank(),\n        strip.background = element_blank(), \n        legend.position = \"none\",\n        plot.title = element_text(size = 12, face = \"bold\",\n                                  hjust = 0.5, vjust = -120)\n        )\n\npatchwork <- (p_ridg_bulkc | p_ridg_cship | p_ridg_fishc | p_ridg_tanker)\npatchwork \n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-26-1.png){width=768}\n:::\n:::\n\n\n\n\n## **Weather Condition**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n###------------1 Plot Bulk Carrier -----------###\n\n# Filter data for only \"Bulk Carrier\" ships\nbulkc_data <- ship_filter %>%\n  filter(Ship_Type == \"Bulk Carrier\")\n\n# Calculate mean profit for each Engine Type and Route Type\nmean_profit_bulkc <- bulkc_data %>%\n  group_by(Engine_Type, Weather_Condition) %>%\n  summarise(mean_profit_bulkc = mean(Profit, na.rm = TRUE), .groups = \"drop\")\n\n# Create Plot_bulkc\np_ridg_bulkc_wc <- ggplot(bulkc_data, aes(x = Profit, \n                        y = Engine_Type, \n                        fill = Weather_Condition, \n                        color = Weather_Condition)) +\n  geom_density_ridges(\n    alpha = 0.2,           \n    scale = 6,            \n    rel_min_height = 0.01,\n    position = \"identity\"   # Ensures full overlap\n  ) +\n  geom_point(data = mean_profit_bulkc, \n             aes(x = mean_profit_bulkc, y = Engine_Type, fill = Weather_Condition), \n             shape = 23, size = 3, stroke = 0.5, color = \"grey90\") +\n  facet_wrap(~ Engine_Type, ncol = 1) +\n  labs(x = \"Bulk Carrier\", y = NULL) +  \n  scale_fill_manual(values = c(\"Rough\" = \"#FF9EAA\",\n                               \"Calm\" = \"#3AA6B9\",\n                               \"Moderate\" = \"grey70\")) +  \n  scale_color_manual(values = c(\"Rough\" = \"#FF9EAA\",\n                               \"Calm\" = \"#3AA6B9\",\n                               \"Moderate\" = \"grey70\")) + \n  theme_classic() +\n  theme(axis.text.y = element_blank(),  \n        axis.ticks.y = element_blank(),\n        axis.line.y = element_blank(),\n        panel.grid.major = element_blank(),  \n        panel.grid.minor = element_blank(),\n        strip.text.y = element_blank(),\n        strip.background = element_blank(), \n        legend.position = \"none\",\n        plot.title = element_text(size = 12, face = \"bold\",\n                                  hjust = 0.5, vjust = -120),\n        panel.spacing = unit(1, \"lines\"),\n        plot.margin = margin(t = 10, r = 10, b = 30, l = 20)\n        ) \n\n\n###------------2 Plot Container Ship -----------###\n# Filter data for only \"Container Ship\" ships\ncship_data <- ship_filter %>%\n  filter(Ship_Type == \"Container Ship\")\n\n# Calculate mean profit for each Engine Type and Route Type\nmean_profit_cship <- cship_data %>%\n  group_by(Engine_Type, Weather_Condition) %>%\n  summarise(mean_profit_cship = mean(Profit, na.rm = TRUE), .groups = \"drop\")\n\n# Create Plot_cship\np_ridg_cship_wc <- ggplot(cship_data, aes(x = Profit, \n                        y = Engine_Type, \n                        fill = Weather_Condition, \n                        color = Weather_Condition)) +\n  geom_density_ridges(\n    alpha = 0.2,           \n    scale = 6,            \n    rel_min_height = 0.01,\n    position = \"identity\"   # Ensures full overlap\n  ) +\n  geom_point(data = mean_profit_cship, \n             aes(x = mean_profit_cship, y = Engine_Type, fill = Weather_Condition), \n             shape = 23, size = 3, stroke = 0.5, color = \"grey90\") +\n  facet_wrap(~ Engine_Type, ncol = 1, strip.position = \"left\") + \n  labs(x = \"Container Ship\", y = NULL) +  \n  scale_fill_manual(values = c(\"Rough\" = \"#FF9EAA\",\n                               \"Calm\" = \"#3AA6B9\",\n                               \"Moderate\" = \"grey70\")) +  \n  scale_color_manual(values = c(\"Rough\" = \"#FF9EAA\",\n                               \"Calm\" = \"#3AA6B9\",\n                               \"Moderate\" = \"grey70\")) + \n  theme_classic() +\n  theme(axis.text.y = element_blank(),  \n        axis.ticks.y = element_blank(),\n        axis.line.y = element_blank(),\n        panel.grid.major = element_blank(),  \n        panel.grid.minor = element_blank(),\n        strip.text.y = element_blank(),\n        strip.background = element_blank(), \n        legend.position = \"top\",\n        plot.title = element_text(size = 12, face = \"bold\",\n                                  hjust = 0.5, vjust = -120),\n        panel.spacing = unit(1, \"lines\")\n        )\n\n\n###-----------3 Plot Fish Carrier -----------###\n# Filter data for only \"Fish Carrier\" ships\nfishc_data <- ship_filter %>%\n  filter(Ship_Type == \"Fish Carrier\")\n\n# Calculate mean profit for each Engine Type and Route Type\nmean_profit_fishc <- fishc_data %>%\n  group_by(Engine_Type, Weather_Condition) %>%\n  summarise(mean_profit_fishc = mean(Profit, na.rm = TRUE), .groups = \"drop\")\n\n# Create Plot_fishc\np_ridg_fishc_wc <- ggplot(fishc_data, aes(x = Profit, \n                        y = Engine_Type, \n                        fill = Weather_Condition, \n                        color = Weather_Condition)) +\n  geom_density_ridges(\n    alpha = 0.2,           \n    scale = 6,            \n    rel_min_height = 0.01,\n    position = \"identity\"   # Ensures full overlap\n  ) +\n  geom_point(data = mean_profit_fishc, \n             aes(x = mean_profit_fishc, y = Engine_Type, fill = Weather_Condition), \n             shape = 23, size = 3, stroke = 0.5, color = \"grey90\") +\n  facet_wrap(~ Engine_Type, ncol = 1, strip.position = \"left\") +  # Separate plots for each Route_Type\n  labs(x = \"Fish Carrier\", y = NULL) +  \n  scale_fill_manual(values = c(\"Rough\" = \"#FF9EAA\",\n                               \"Calm\" = \"#3AA6B9\",\n                               \"Moderate\" = \"grey70\")) +  \n  scale_color_manual(values = c(\"Rough\" = \"#FF9EAA\",\n                               \"Calm\" = \"#3AA6B9\",\n                               \"Moderate\" = \"grey70\")) + \n  theme_classic() +\n  theme(axis.text.y = element_blank(),  \n        axis.ticks.y = element_blank(),\n        axis.line.y = element_blank(),\n        panel.grid.major = element_blank(),  \n        panel.grid.minor = element_blank(),\n        strip.text.y = element_blank(),\n        strip.background = element_blank(), \n        legend.position = \"none\",\n        plot.title = element_text(size = 12, face = \"bold\",\n                                  hjust = 0.5, vjust = -120),\n        panel.spacing = unit(1, \"lines\")\n        )\n\n###-----------4 Plot Tanker-----------###\n# Filter data for only \"Tanker\" ships\ntanker_data <- ship_filter %>%\n  filter(Ship_Type == \"Tanker\")\n\n# Calculate mean profit for each Engine Type and Route Type\nmean_profit_tanker <- tanker_data %>%\n  group_by(Engine_Type, Weather_Condition) %>%\n  summarise(mean_profit_tanker = mean(Profit, na.rm = TRUE), .groups = \"drop\")\n\n# Create Plot_tanker\np_ridg_tanker_wc <- ggplot(tanker_data, aes(x = Profit, \n                        y = Engine_Type, \n                        fill = Weather_Condition, \n                        color = Weather_Condition)) +\n  geom_density_ridges(\n    alpha = 0.2,           \n    scale = 6,            \n    rel_min_height = 0.01,\n    position = \"identity\"   # Ensures full overlap\n  ) +\n  geom_point(data = mean_profit_tanker, \n             aes(x = mean_profit_tanker, y = Engine_Type, fill = Weather_Condition), \n             shape = 23, size = 3, stroke = 0.5, color = \"grey90\") +\n  facet_wrap(~ Engine_Type, ncol = 1, strip.position = \"left\") +  # Separate plots for each Route_Type\n  labs(x = \"Tanker\", y = NULL) +  \n  scale_fill_manual(values = c(\"Rough\" = \"#FF9EAA\",\n                               \"Calm\" = \"#3AA6B9\",\n                               \"Moderate\" = \"grey70\")) +  \n  scale_color_manual(values = c(\"Rough\" = \"#FF9EAA\",\n                               \"Calm\" = \"#3AA6B9\",\n                               \"Moderate\" = \"grey70\")) + \n  theme_classic() +\n  theme(axis.text.y = element_blank(),  \n        axis.ticks.y = element_blank(),\n        axis.line.y = element_blank(),\n        panel.grid.major = element_blank(),  \n        panel.grid.minor = element_blank(),\n        strip.text.y = element_blank(),\n        strip.background = element_blank(), \n        legend.position = \"none\",\n        plot.title = element_text(size = 12, face = \"bold\",\n                                  hjust = 0.5, vjust = -120)\n        )\n\npatchwork <- (p_ridg_bulkc_wc | p_ridg_cship_wc | p_ridg_fishc_wc | p_ridg_tanker_wc)\npatchwork \n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-27-1.png){width=768}\n:::\n:::\n\n\n\n\n## **Maintenance status**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n###------------1 Plot Bulk Carrier -----------###\n\n# Filter data for only \"Bulk Carrier\" ships\nbulkc_data <- ship_filter %>%\n  filter(Ship_Type == \"Bulk Carrier\")\n\n# Calculate mean profit for each Engine Type and Route Type\nmean_profit_bulkc <- bulkc_data %>%\n  group_by(Engine_Type, Maintenance_Status) %>%\n  summarise(mean_profit_bulkc = mean(Profit, na.rm = TRUE), .groups = \"drop\")\n\n# Create Plot_bulkc\np_ridg_bulkc_ms <- ggplot(bulkc_data, aes(x = Profit, \n                        y = Engine_Type, \n                        fill = Maintenance_Status, \n                        color = Maintenance_Status)) +\n  geom_density_ridges(\n    alpha = 0.2,           \n    scale = 6,            \n    rel_min_height = 0.01,\n    position = \"identity\"   # Ensures full overlap\n  ) +\n  geom_point(data = mean_profit_bulkc, \n             aes(x = mean_profit_bulkc, y = Engine_Type, fill = Maintenance_Status), \n             shape = 23, size = 3, stroke = 0.5, color = \"grey90\") +\n  facet_wrap(~ Engine_Type, ncol = 1) +\n  labs(x = \"Bulk Carrier\", y = NULL) +  \n  scale_fill_manual(values = c(\"Critical\" = \"#FF9EAA\",\n                               \"Good\" = \"#3AA6B9\",\n                               \"Fair\" = \"grey70\")) +  \n  scale_color_manual(values = c(\"Critical\" = \"#FF9EAA\",\n                               \"Good\" = \"#3AA6B9\",\n                               \"Fair\" = \"grey70\")) + \n  theme_classic() +\n  theme(axis.text.y = element_blank(),  \n        axis.ticks.y = element_blank(),\n        axis.line.y = element_blank(),\n        panel.grid.major = element_blank(),  \n        panel.grid.minor = element_blank(),\n        strip.text.y = element_blank(),\n        strip.background = element_blank(), \n        legend.position = \"none\",\n        plot.title = element_text(size = 12, face = \"bold\",\n                                  hjust = 0.5, vjust = -120),\n        panel.spacing = unit(1, \"lines\"),\n        plot.margin = margin(t = 10, r = 10, b = 30, l = 20)\n        ) \n\n\n###------------2 Plot Container Ship -----------###\n# Filter data for only \"Container Ship\" ships\ncship_data <- ship_filter %>%\n  filter(Ship_Type == \"Container Ship\")\n\n# Calculate mean profit for each Engine Type and Route Type\nmean_profit_cship <- cship_data %>%\n  group_by(Engine_Type, Maintenance_Status) %>%\n  summarise(mean_profit_cship = mean(Profit, na.rm = TRUE), .groups = \"drop\")\n\n# Create Plot_cship\np_ridg_cship_ms <- ggplot(cship_data, aes(x = Profit, \n                        y = Engine_Type, \n                        fill = Maintenance_Status, \n                        color = Maintenance_Status)) +\n  geom_density_ridges(\n    alpha = 0.2,           \n    scale = 6,            \n    rel_min_height = 0.01,\n    position = \"identity\"   # Ensures full overlap\n  ) +\n  geom_point(data = mean_profit_cship, \n             aes(x = mean_profit_cship, y = Engine_Type, fill = Maintenance_Status), \n             shape = 23, size = 3, stroke = 0.5, color = \"grey90\") +\n  facet_wrap(~ Engine_Type, ncol = 1, strip.position = \"left\") + \n  labs(x = \"Container Ship\", y = NULL) +  \n  scale_fill_manual(values = c(\"Critical\" = \"#FF9EAA\",\n                               \"Good\" = \"#3AA6B9\",\n                               \"Fair\" = \"grey70\")) +  \n  scale_color_manual(values = c(\"Critical\" = \"#FF9EAA\",\n                               \"Good\" = \"#3AA6B9\",\n                               \"Fair\" = \"grey70\")) + \n  theme_classic() +\n  theme(axis.text.y = element_blank(),  \n        axis.ticks.y = element_blank(),\n        axis.line.y = element_blank(),\n        panel.grid.major = element_blank(),  \n        panel.grid.minor = element_blank(),\n        strip.text.y = element_blank(),\n        strip.background = element_blank(), \n        legend.position = \"top\",\n        plot.title = element_text(size = 12, face = \"bold\",\n                                  hjust = 0.5, vjust = -120),\n        panel.spacing = unit(1, \"lines\")\n        )\n\n\n###-----------3 Plot Fish Carrier -----------###\n# Filter data for only \"Fish Carrier\" ships\nfishc_data <- ship_filter %>%\n  filter(Ship_Type == \"Fish Carrier\")\n\n# Calculate mean profit for each Engine Type and Route Type\nmean_profit_fishc <- fishc_data %>%\n  group_by(Engine_Type, Maintenance_Status) %>%\n  summarise(mean_profit_fishc = mean(Profit, na.rm = TRUE), .groups = \"drop\")\n\n# Create Plot_fishc\np_ridg_fishc_ms <- ggplot(fishc_data, aes(x = Profit, \n                        y = Engine_Type, \n                        fill = Maintenance_Status, \n                        color = Maintenance_Status)) +\n  geom_density_ridges(\n    alpha = 0.2,           \n    scale = 6,            \n    rel_min_height = 0.01,\n    position = \"identity\"   # Ensures full overlap\n  ) +\n  geom_point(data = mean_profit_fishc, \n             aes(x = mean_profit_fishc, y = Engine_Type, fill = Maintenance_Status), \n             shape = 23, size = 3, stroke = 0.5, color = \"grey90\") +\n  facet_wrap(~ Engine_Type, ncol = 1, strip.position = \"left\") +  # Separate plots for each Route_Type\n  labs(x = \"Fish Carrier\", y = NULL) +  \n  scale_fill_manual(values = c(\"Critical\" = \"#FF9EAA\",\n                               \"Good\" = \"#3AA6B9\",\n                               \"Fair\" = \"grey70\")) +  \n  scale_color_manual(values = c(\"Critical\" = \"#FF9EAA\",\n                               \"Good\" = \"#3AA6B9\",\n                               \"Fair\" = \"grey70\")) + \n  theme_classic() +\n  theme(axis.text.y = element_blank(),  \n        axis.ticks.y = element_blank(),\n        axis.line.y = element_blank(),\n        panel.grid.major = element_blank(),  \n        panel.grid.minor = element_blank(),\n        strip.text.y = element_blank(),\n        strip.background = element_blank(), \n        legend.position = \"none\",\n        plot.title = element_text(size = 12, face = \"bold\",\n                                  hjust = 0.5, vjust = -120),\n        panel.spacing = unit(1, \"lines\")\n        )\n\n###-----------4 Plot Tanker-----------###\n# Filter data for only \"Tanker\" ships\ntanker_data <- ship_filter %>%\n  filter(Ship_Type == \"Tanker\")\n\n# Calculate mean profit for each Engine Type and Route Type\nmean_profit_tanker <- tanker_data %>%\n  group_by(Engine_Type, Maintenance_Status) %>%\n  summarise(mean_profit_tanker = mean(Profit, na.rm = TRUE), .groups = \"drop\")\n\n# Create Plot_tanker\np_ridg_tanker_ms <- ggplot(tanker_data, aes(x = Profit, \n                        y = Engine_Type, \n                        fill = Maintenance_Status, \n                        color = Maintenance_Status)) +\n  geom_density_ridges(\n    alpha = 0.2,           \n    scale = 6,            \n    rel_min_height = 0.01,\n    position = \"identity\"   # Ensures full overlap\n  ) +\n  geom_point(data = mean_profit_tanker, \n             aes(x = mean_profit_tanker, y = Engine_Type, fill = Maintenance_Status), \n             shape = 23, size = 3, stroke = 0.5, color = \"grey90\") +\n  facet_wrap(~ Engine_Type, ncol = 1, strip.position = \"left\") +  # Separate plots for each Route_Type\n  labs(x = \"Tanker\", y = NULL) +  \n  scale_fill_manual(values = c(\"Critical\" = \"#FF9EAA\",\n                               \"Good\" = \"#3AA6B9\",\n                               \"Fair\" = \"grey70\")) +  \n  scale_color_manual(values = c(\"Critical\" = \"#FF9EAA\",\n                               \"Good\" = \"#3AA6B9\",\n                               \"Fair\" = \"grey70\")) + \n  theme_classic() +\n  theme(axis.text.y = element_blank(),  \n        axis.ticks.y = element_blank(),\n        axis.line.y = element_blank(),\n        panel.grid.major = element_blank(),  \n        panel.grid.minor = element_blank(),\n        strip.text.y = element_blank(),\n        strip.background = element_blank(), \n        legend.position = \"none\",\n        plot.title = element_text(size = 12, face = \"bold\",\n                                  hjust = 0.5, vjust = -120)\n        )\n\npatchwork <- (p_ridg_bulkc_ms | p_ridg_cship_ms | p_ridg_fishc_ms | p_ridg_tanker_ms)\npatchwork \n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-28-1.png){width=768}\n:::\n:::\n\n\n\n:::\n\n::::: spgoals\n::: spgoals-header\nInsights\n:::\n\n::: spgoals-container\n-   text\n:::\n:::::\n\n#### **5.2.2 Performance Metrics**\n\n::: panel-tabset\n## **Energy Efficiency**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\np_pt_ep <- ggplot(data=ship_filter,\n             aes(x = Efficiency_nm_per_kWh,\n                 y = Profit)) +\n  geom_point(size = 0.6,\n             aes(color = Ship_Type),\n             show.legend = FALSE) +\n  geom_smooth(method = lm,\n              size = 0.5) +\n  coord_cartesian(xlim=c(.1,1.5),\n                 ylim=c(-500,1000)) +\n  labs(title = \"Turnaround Time with Overall Trend Line\") +\n  theme_classic() +\n  theme(plot.title = element_text(size = 10, face = \"bold\"),\n        plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA)) +\n  scale_color_manual(values = c(\"Bulk Carrier\" = \"#FF9EAA\", \n                                \"Container Ship\" = \"#3AA6B9\",\n                                \"Fish Carrier\" = \"#e0c080\",\n                                \"Tanker\" = \"#a5c7a7\")) \n\n\np_pt_ep_st <- ggplot(data=ship_filter,\n             aes(x = Efficiency_nm_per_kWh,\n                 y = Profit,\n                 color = Ship_Type)) +\n  geom_point(colour = \"grey80\",\n             size = 0.6) +\n  geom_smooth(method = lm,\n              size = 0.5,\n              se = FALSE,\n              aes(color = Ship_Type)) +\n  scale_color_brewer(palette = \"Set2\") +\n  coord_cartesian(xlim=c(.1,1.5),\n                 ylim=c(-500,1000)) +\n  labs(title = \"Turnaround Time with Trend Lines for All Ship Types\",\n       color = \"Ship Type\") +\n  theme_classic() +\n  theme(plot.title = element_text(size = 10, face = \"bold\"),\n        legend.text = element_text(size=10),\n        legend.position = \"right\",\n        plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        legend.background = element_rect(fill = \"#f1f4f5\", color = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"lightblue\", color = NA)\n        ) +\n  scale_color_manual(values = c(\"Bulk Carrier\" = \"#FF9EAA\", \n                                \"Container Ship\" = \"#3AA6B9\",\n                                \"Fish Carrier\" = \"#e0c080\",\n                                \"Tanker\" = \"#a5c7a7\")) \n\npatchwork <- (p_pt_ep | p_pt_ep_st)\npatchwork + \n  theme(plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-29-1.png){width=768}\n:::\n:::\n\n\n\n\n## **Engine Power**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\np_pt_ep <- ggplot(data=ship_filter,\n             aes(x = Engine_Power_kW,\n                 y = Profit)) +\n  geom_point(size = 0.6,\n             aes(color = Ship_Type),\n             show.legend = FALSE) +\n  geom_smooth(method = lm,\n              size = 0.5) +\n  coord_cartesian(xlim=c(500,3000),\n                 ylim=c(-500,1000)) +\n  labs(title = \"Turnaround Time with Overall Trend Line\") +\n  theme_classic() +\n  theme(plot.title = element_text(size = 10, face = \"bold\"),\n        plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA)\n        ) +\n  scale_color_manual(values = c(\"Bulk Carrier\" = \"#FF9EAA\", \n                                \"Container Ship\" = \"#3AA6B9\",\n                                \"Fish Carrier\" = \"#e0c080\",\n                                \"Tanker\" = \"#a5c7a7\")) \n\n\np_pt_ep_st <- ggplot(data=ship_filter,\n             aes(x = Engine_Power_kW,\n                 y = Profit,\n                 color = Ship_Type)) +\n  geom_point(colour = \"grey80\",\n             size = 0.6) +\n  geom_smooth(method = lm,\n              size = 0.5,\n              se = FALSE,\n              aes(color = Ship_Type)) +\n  scale_color_brewer(palette = \"Set2\") +\n  coord_cartesian(xlim=c(500,3000),\n                 ylim=c(-500,1000)) +\n  labs(title = \"Turnaround Time with Trend Lines for All Ship Types\",\n       color = \"Ship Type\") +\n  theme_classic() +\n  theme(plot.title = element_text(size = 10, face = \"bold\"),\n        legend.text = element_text(size=10),\n        legend.position = \"right\",\n        plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        legend.background = element_rect(fill = \"#f1f4f5\", color = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA)\n        ) +\n  scale_color_manual(values = c(\"Bulk Carrier\" = \"#FF9EAA\", \n                                \"Container Ship\" = \"#3AA6B9\",\n                                \"Fish Carrier\" = \"#e0c080\",\n                                \"Tanker\" = \"#a5c7a7\")) \n\npatchwork <- (p_pt_ep | p_pt_ep_st)\npatchwork + theme(\n        plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        legend.background = element_rect(fill = \"#f1f4f5\", color = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA)\n)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-30-1.png){width=768}\n:::\n:::\n\n\n\n\n## **Average load**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\np5 <- ggplot(data=ship_filter,\n             aes(x = Average_Load_Percentage,\n                 y = Profit)) +\n  geom_point(size = 0.6,\n             aes(color = Ship_Type),\n             show.legend = FALSE) +\n  geom_smooth(method = lm,\n              size = 0.5) +\n  coord_cartesian(xlim=c(40,100),\n                 ylim=c(-500,1000)) +\n  labs(title = \"Average Load vs Profit\") +\n  theme_classic() +\n  theme(plot.title = element_text(size = 10, face = \"bold\"),\n        plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        legend.background = element_rect(fill = \"#f1f4f5\", color = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA)) +\n  scale_color_manual(values = c(\"Bulk Carrier\" = \"#FF9EAA\", \n                                \"Container Ship\" = \"#3AA6B9\",\n                                \"Fish Carrier\" = \"#e0c080\",\n                                \"Tanker\" = \"#a5c7a7\")) \n\n\np5_1 <- ggplot(data=ship_filter,\n             aes(x = Average_Load_Percentage,\n                 y = Profit,\n                 color = Ship_Type)) +\n  geom_point(colour = \"grey\",\n             size = 0.6) +\n  geom_smooth(method = lm,\n              size = 0.5,\n              se = FALSE,\n              aes(color = Ship_Type)) +\n  scale_color_brewer(palette = \"Set2\") +\n  coord_cartesian(xlim=c(40,100),\n                 ylim=c(-500,1000)) +\n  labs(title = \"Average Load vs Profit by All Ship Types\",\n       color = \"Ship Type\") +\n  theme_classic() +\n  theme(plot.title = element_text(size = 10, face = \"bold\"),\n        legend.text = element_text(size=10),\n        legend.position = \"right\",\n        plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        legend.background = element_rect(fill = \"#f1f4f5\", color = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA)\n        ) +\n  scale_color_manual(values = c(\"Bulk Carrier\" = \"#FF9EAA\", \n                                \"Container Ship\" = \"#3AA6B9\",\n                                \"Fish Carrier\" = \"#e0c080\",\n                                \"Tanker\" = \"#a5c7a7\")) \n\n\npatchwork <- (p5 | p5_1)\npatchwork + theme(\n        plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        legend.background = element_rect(fill = \"#f1f4f5\", color = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-31-1.png){width=768}\n:::\n:::\n\n\n\n\n## **Turnaround time**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\np_pt_turntime <- ggplot(data=ship_filter,\n             aes(x = Turnaround_Time_hours,\n                 y = Profit)) +\n  geom_point(size = 0.6,\n             aes(color = Ship_Type),\n             show.legend = FALSE) +\n  geom_smooth(method = lm,\n              size = 0.5) +\n  coord_cartesian(xlim=c(0,80),\n                 ylim=c(-500,1000)) +\n  labs(title = \"Turnaround Time with Overall Trend Line\") +\n  theme_classic() +\n  theme(plot.title = element_text(size = 10, face = \"bold\"),\n        plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA)) +\n  scale_color_manual(values = c(\"Bulk Carrier\" = \"#FF9EAA\", \n                                \"Container Ship\" = \"#3AA6B9\",\n                                \"Fish Carrier\" = \"#e0c080\",\n                                \"Tanker\" = \"#a5c7a7\")) \n\n\np_pt_turntime_st <- ggplot(data=ship_filter,\n             aes(x = Turnaround_Time_hours,\n                 y = Profit,\n                 color = Ship_Type)) +\n  geom_point(colour = \"grey80\",\n             size = 0.6) +\n  geom_smooth(method = lm,\n              size = 0.5,\n              se = FALSE,\n              aes(color = Ship_Type)) +\n  scale_color_brewer(palette = \"Set2\") +\n  coord_cartesian(xlim=c(0, 80),\n                 ylim=c(-500,1000)) +\n  labs(title = \"Turnaround Time with Trend Lines for All Ship Types\",\n       color = \"Ship Type\") +\n  theme_classic() +\n  theme(plot.title = element_text(size = 10, face = \"bold\"),\n        legend.text = element_text(size=10),\n        legend.position = \"right\",\n        plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        legend.background = element_rect(fill = \"#f1f4f5\", color = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA)) +\n  scale_color_manual(values = c(\"Bulk Carrier\" = \"#FF9EAA\", \n                                \"Container Ship\" = \"#3AA6B9\",\n                                \"Fish Carrier\" = \"#e0c080\",\n                                \"Tanker\" = \"#a5c7a7\")) \n\npatchwork <- p_pt_turntime | p_pt_turntime_st\npatchwork + theme(\n        plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        legend.background = element_rect(fill = \"#f1f4f5\", color = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA)\n)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-32-1.png){width=768}\n:::\n:::\n\n\n\n\n## **Cargo Weight**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\np_pt_cargowt <- ggplot(data=ship_filter,\n             aes(x = Cargo_Weight_tons,\n                 y = Profit)) +\n  geom_point(size = 0.6,\n             aes(color = Ship_Type),\n             show.legend = FALSE) +\n  geom_smooth(method = lm,\n              size = 0.5) +\n  coord_cartesian(xlim=c(50,2000),\n                 ylim=c(-500,1000)) +\n  labs(title = \"Turnaround Time with Overall Trend Line\") +\n  theme_classic() +\n  theme(plot.title = element_text(size = 10, face = \"bold\"),\n        plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA)) +\n  scale_color_manual(values = c(\"Bulk Carrier\" = \"#FF9EAA\", \n                                \"Container Ship\" = \"#3AA6B9\",\n                                \"Fish Carrier\" = \"#e0c080\",\n                                \"Tanker\" = \"#a5c7a7\")) \n\n\np_pt_cargowt_st <- ggplot(data=ship_filter,\n             aes(x = Cargo_Weight_tons,\n                 y = Profit,\n                 color = Ship_Type)) +\n  geom_point(colour = \"grey80\",\n             size = 0.6) +\n  geom_smooth(method = lm,\n              size = 0.5,\n              se = FALSE,\n              aes(color = Ship_Type)) +\n  scale_color_brewer(palette = \"Set2\") +\n  coord_cartesian(xlim=c(50, 2000),\n                 ylim=c(-500,1000)) +\n  labs(title = \"Turnaround Time with Trend Lines for All Ship Types\",\n       color = \"Ship Type\") +\n  theme_classic() +\n  theme(plot.title = element_text(size = 10, face = \"bold\"),\n        legend.text = element_text(size=10),\n        legend.position = \"right\",\n        plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        legend.background = element_rect(fill = \"#f1f4f5\", color = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA)\n        ) +\n  scale_color_manual(values = c(\"Bulk Carrier\" = \"#FF9EAA\", \n                                \"Container Ship\" = \"#3AA6B9\",\n                                \"Fish Carrier\" = \"#e0c080\",\n                                \"Tanker\" = \"#a5c7a7\")) \n\npatchwork <- p_pt_cargowt | p_pt_cargowt_st\npatchwork + theme(\n        plot.background = element_rect(fill = \"#f1f4f5\", color = NA),\n        legend.background = element_rect(fill = \"#f1f4f5\", color = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\", color = NA)\n)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-33-1.png){width=768}\n:::\n:::\n\n\n\n:::\n\n::::: spgoals\n::: spgoals-header\nInsights\n:::\n\n::: spgoals-container\n-   text\n:::\n:::::\n\n### 5.3 Performance over time\n\n#### **5.3.1 Financial performance overview**\n\nMar, July, Oct, Dec are peak months in the data in a one year time frame. The cost, revenue and profit shows the same pattern in the line graph. It would be good to look into the reasons why these months are peak time and what causes the cost increase.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Extract month and year from the Date\nship_filter_month <- ship_filter %>%\n  mutate(Month = floor_date(Date, \"month\"))\n\n# Group by month and calculate total profit, cost, and revenue\nmonthly_totals <- ship_filter_month %>%\n  group_by(Month) %>%\n  summarise(\n    Profit = sum(Profit, na.rm = TRUE),\n    Op_Cost = sum(Operational_Cost_USD, na.rm = TRUE),\n    Revenue = sum(Revenue_per_Voyage_USD, na.rm = TRUE)\n  )\n\n# Sort the data by Total_Profit in descending order and select the top 5 months\ntop_5_months <- monthly_totals %>%\n  arrange(desc(Profit)) %>%\n  slice_head(n = 5) %>%\n  mutate(\n    #Month_label = format(Month, \"%m/%y\"),  # Format date as mm/yy\n         Profit_label = paste0(\"$\", round(Profit, 2)))  # Create the label\n\n# Reshape the data from wide to long format\nmonthly_long <- monthly_totals %>%\n  pivot_longer(cols = c(Profit, Op_Cost, Revenue),\n               names_to = \"Type\",\n               values_to = \"Value\")\n\n# Plot total profit, total cost, and total revenue over time\nggplot(monthly_long, aes(x = Month, y = Value, color = Type, group = Type)) +\n  \n  geom_line(size = 0.6) +  # Line plot for each variable\n  geom_point(data = top_5_months, \n             aes(x = Month, y = Profit), \n             color = \"red\", size = 3.5, shape = 21, fill = \"red\",\n             inherit.aes = FALSE) + # Prevent from inheriting \"Type\"\n  geom_text(data = top_5_months, \n            aes(x = Month, y = Profit, label = Profit_label),\n            color = \"black\", size = 3.5, vjust = -2, hjust = 0.5,\n            inherit.aes = FALSE) +\n  labs(title = \"Profit, Cost, and Revenue Over Time\",\n       x = \"Month\",\n       y = \"Amount (1K USD)\",\n       color = \"Type\") +\n    \n  theme_light() +\n  scale_color_manual(values = c(\"Profit\" = \"#f2cbd0\", \"Op_Cost\" = \"grey70\", \n                                \"Revenue\" = \"#86b3ba\"),\n                     guide = \"none\") +\n  scale_x_date(labels = scales::date_format(\"%m/%y\"), breaks = \"1 month\") +\n  theme(plot.title = element_text(size = 14, face = \"bold\"),\n        legend.position = \"top\",\n        plot.background = element_rect(fill = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\"),\n        panel.border = element_blank()) +\n  geomtextpath::geom_textline(\n    aes(label = Type),\n    linewidth = 1,\n    fontface = \"bold\",\n    size = 3,\n    vjust = -.4,\n    hjust = .5) \n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-34-1.png){width=768}\n:::\n:::\n\n\n\n\n::::: spgoals\n::: spgoals-header\nInsights\n:::\n\n::: spgoals-container\n-   text\n:::\n:::::\n\n#### **5.3.2 Comparing Profit, Revenue, and Cost Across Ship Types**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n###--------------- Plot profit\n# Aggregate total monthly profit for each ship type\nmonthly_profit <- ship_filter %>%\n  mutate(Month = floor_date(Date, \"month\")) %>%\n  group_by(Month, Ship_Type) %>%\n  summarise(Total_profit = sum(Profit, na.rm = TRUE), \n            .groups = \"drop\")\n\n# Identify top 3 months for each type\ntop_3_months <- monthly_profit %>%\n  group_by(Ship_Type) %>%\n  slice_max(order_by = Total_profit, n = 3)\n\n# Define colors\nship_type_colors <- c(\"#f2cbd0\", \"grey80\", \"grey40\", \"#9bc5cc\")\n\n# Plot profit over time for each ship type\np_line_pf <- ggplot(monthly_profit, \n      aes(x = Month, \n          y = Total_profit, \n          color = Ship_Type, \n          group = Ship_Type)) +\n  geom_line(size = .8) + \n  geom_point(data = top_3_months, \n             aes(x = Month,\n                 y = Total_profit,\n                 inherit.aes = FALSE),\n             size = 3, shape = 21,\n             color = ship_type_colors[as.factor(top_3_months$Ship_Type)], \n             stroke = 1.5) +\n  labs(title = \"Monthly Profit Trends by Ship Type\",\n       x = \"Month\",\n       y = \"Total Profit (1KUSD)\",\n       color = \"Ship Type\") +\n  scale_color_manual(values = ship_type_colors) +  \n  scale_x_date(labels = scales::date_format(\"%m/%y\"), breaks = \"1 month\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 14, face = \"bold\"),\n        legend.position = \"top\",\n        legend.background = element_rect(fill = \"#f1f4f5\", color = \"#f1f4f5\"),\n        legend.title = element_blank(),\n        plot.background = element_rect(fill = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\"),\n        panel.border = element_blank()) +\n  guides(fill = \"none\")\n\n###--------------- Plot cost \n# Aggregate total monthly cost for each ship type\nmonthly_cost <- ship_filter %>%\n  mutate(Month = floor_date(Date, \"month\")) %>%\n  group_by(Month, Ship_Type) %>%\n  summarise(Total_cost = sum(Operational_Cost_USD, na.rm = TRUE), \n            .groups = \"drop\")\n\n# Identify top 3 months for each type\ntop_3_months_cost <- monthly_cost %>%\n  group_by(Ship_Type) %>%\n  slice_max(order_by = Total_cost, n = 3)\n\n# Define colors\nship_type_colors <- c(\"#f2cbd0\", \"grey80\", \"grey40\", \"#9bc5cc\")\n\n# Plot cost over time for each ship type\np_line_cost <- ggplot(monthly_cost, \n      aes(x = Month, \n          y = Total_cost, \n          color = Ship_Type, \n          group = Ship_Type)) +\n  geom_line(size = .8, linetype = \"twodash\") + \n  geom_point(data = top_3_months_cost, \n             aes(x = Month,\n                 y = Total_cost,\n                 inherit.aes = FALSE),\n             size = 3, shape = 21,\n             color = ship_type_colors[as.factor(top_3_months_cost$Ship_Type)], \n             stroke = 1.5) +\n  labs(title = \"Monthly Cost Trends by Ship Type\",\n       x = \"Month\",\n       y = \"Total Cost (1KUSD)\",\n       color = \"Ship Type\") +\n  scale_color_manual(values = ship_type_colors) +  \n  scale_x_date(labels = scales::date_format(\"%m/%y\"), breaks = \"1 month\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 14, face = \"bold\"),\n        legend.position = \"top\",\n        legend.background = element_rect(fill = \"#fcf0cc\", color = \"#fcf0cc\"),\n        legend.title = element_blank(),\n        plot.background = element_rect(fill = \"#fcf0cc\"),\n        panel.background = element_rect(fill = \"#fcf0cc\"),\n        panel.border = element_blank()) +\n  guides(fill = \"none\")\n\n###--------------- Plot revenue \n# Aggregate total monthly revenue for each ship type\nmonthly_rvn <- ship_filter %>%\n  mutate(Month = floor_date(Date, \"month\")) %>%\n  group_by(Month, Ship_Type) %>%\n  summarise(Total_rvn = sum(Revenue_per_Voyage_USD, na.rm = TRUE), \n            .groups = \"drop\")\n\n# Identify top 3 months for each type\ntop_3_months_rvn <- monthly_rvn %>%\n  group_by(Ship_Type) %>%\n  slice_max(order_by = Total_rvn, n = 3)\n\n# Define colors\nship_type_colors <- c(\"#e0bcc0\", \"grey80\", \"grey40\", \"#86b3ba\")\n\n# Plot revenue over time for each ship type\np_line_rvn <- ggplot(monthly_rvn, \n      aes(x = Month, \n          y = Total_rvn, \n          color = Ship_Type, \n          group = Ship_Type)) +\n  geom_line(size = .8, linetype = \"dotted\") + \n  geom_point(data = top_3_months_rvn, \n             aes(x = Month,\n                 y = Total_rvn,\n                 inherit.aes = FALSE),\n             size = 3, shape = 21,\n             color = ship_type_colors[as.factor(top_3_months_rvn$Ship_Type)], \n             stroke = 1.5) +\n  labs(title = \"Monthly Revenue Trends by Ship Type\",\n       x = \"Month\",\n       y = \"Total Revenue (1KUSD)\",\n       color = \"Ship Type\") +\n  scale_color_manual(values = ship_type_colors) +  \n  scale_x_date(labels = scales::date_format(\"%m/%y\"), breaks = \"1 month\") +\n  theme_light() +\n  theme(plot.title = element_text(size = 14, face = \"bold\"),\n        legend.position = \"top\",\n        legend.background = element_rect(fill = \"#f1f4f5\", color = \"#f1f4f5\"),\n        legend.title = element_blank(),\n        plot.background = element_rect(fill = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\"),\n        panel.border = element_blank()) +\n  guides(fill = \"none\") \n\np_line_pf / p_line_cost / p_line_rvn \n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-35-1.png){width=768}\n:::\n:::\n\n\n\n\n::::: spgoals\n::: spgoals-header\nInsights\n:::\n\n::: spgoals-container\n-   text\n:::\n:::::\n\n#### 5.3.3 **Monthly Profit, Revenue, and Cost Trends by Ship Type**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Extract month and year from the Date\nship_filter_month <- ship_filter %>%\n  mutate(Month = floor_date(Date, \"month\"))\n\n# Group by month and calculate total profit, cost, and revenue\nmonthly_totals_st <- ship_filter_month %>%\n  group_by(Month, Ship_Type) %>%\n  summarise(\n    Profit = sum(Profit, na.rm = TRUE),\n    Op_Cost = sum(Operational_Cost_USD, na.rm = TRUE),\n    Revenue = sum(Revenue_per_Voyage_USD, na.rm = TRUE),\n    .groups = \"drop\"\n  ) \n\n# Sort the data by Total_Profit in descending order and select the top 5 months\ntop_5_months <- monthly_totals_st %>%\n  arrange(desc(Profit)) %>%\n  slice_head(n = 5) %>%\n  mutate(\n    #Month_label = format(Month, \"%m/%y\"),  # Format date as mm/yy\n         Profit_label = paste0(\"$\", round(Profit, 2)))  # Create the label\n\n# Reshape the data from wide to long format\nmonthly_long_st <- monthly_totals_st %>%\n  pivot_longer(cols = c(Profit, Op_Cost, Revenue),\n               names_to = \"Type\",\n               values_to = \"Value\")\n\n# Plot total profit, total cost, and total revenue over time\nggplot(monthly_long_st, aes(x = Month, y = Value, color = Type, group = interaction(Ship_Type, Type))) +\n  geom_line(size = 0.3) +  # Line plot for each variable\n  geom_point(data = top_5_months, \n             aes(x = Month, y = Profit), \n             color = \"red\", size = 3, shape = 21, fill = \"red\",\n             inherit.aes = FALSE) + # Prevent from inheriting \"Type\"\n  geom_text(data = top_5_months, \n            aes(x = Month, y = Profit, label = Profit_label),\n            color = \"black\", size = 3.5, vjust = -2, hjust = 0.5,\n            inherit.aes = FALSE) +\n  labs(title = \"Profit, Cost, and Revenue Over Time by Ship Type\",\n       x = \"Month\",\n       y = \"Amount (1K USD)\",\n       color = \"Type\") +\n    \n  theme_light() +\n  scale_color_manual(values = c(\"Profit\" = \"#f2cbd0\", \"Op_Cost\" = \"grey70\", \n                                \"Revenue\" = \"#9bc5cc\"),\n                     guide = \"none\") +\n  scale_x_date(labels = scales::date_format(\"%m/%y\"), breaks = \"1 month\") +\n  theme(plot.title = element_text(size = 14, face = \"bold\"),\n        legend.position = \"top\"\n        ) +\n  theme(plot.background = element_rect(fill = \"#f1f4f5\"),\n        panel.background = element_rect(fill = \"#f1f4f5\"),\n        panel.border = element_blank(),\n        axis.text.x = element_text(angle = 45, hjust = 1)) +\n  geomtextpath::geom_textline(\n    aes(label = Type),\n    linewidth = 1,\n    fontface = \"bold\",\n    size = 2,\n    vjust = -.4,\n    hjust = .5) +\n  facet_wrap(~ Ship_Type, scales = \"free_y\") #facet by ship type\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-36-1.png){width=768}\n:::\n:::\n\n\n\n\n::::: spgoals\n::: spgoals-header\nInsights\n:::\n\n::: spgoals-container\n-   text\n:::\n:::::\n\n#### 5.3.4 Revenue vs Profit relations\n\nmonth revenue / total revenue\n\nmonth profit / total profit\n\nplot scatter plot, point size denotes profit amount\n\n## 6 Summary\n\n## 7 References\n",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}